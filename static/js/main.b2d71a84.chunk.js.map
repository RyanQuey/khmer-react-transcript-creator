{"version":3,"sources":["lib/TranscriptEditor/MediaPlayer/ProgressBar.module.css","lib/TranscriptEditor/MediaPlayer/Select.module.css","lib/TranscriptEditor/Settings/index.module.css","lib/TranscriptEditor/MediaPlayer/PlayerControls.module.css","lib/TranscriptEditor/TimedTextEditor/index.module.css","lib/TranscriptEditor/TimedTextEditor/WrapperBlock.module.css","lib/TranscriptEditor/TimedTextEditor/Word.js","lib/TranscriptEditor/TimedTextEditor/SpeakerLabel.js","lib/Util/timecode-converter/secondsToTimecode.js","lib/Util/timecode-converter/timecodeToSeconds.js","lib/Util/timecode-converter/padTimeToTimecode.js","lib/Util/timecode-converter/index.js","lib/Util/khmer-numbers/index.js","lib/TranscriptEditor/TimedTextEditor/WrapperBlock.js","lib/Util/adapters/bbc-kaldi/index.js","lib/Util/adapters/generate-entities-ranges/index.js","lib/Util/adapters/autoEdit2/index.js","lib/Util/adapters/speechmatics/index.js","lib/Util/adapters/index.js","lib/Util/export-adapters/txt/index.js","lib/Util/export-adapters/index.js","lib/TranscriptEditor/TimedTextEditor/index.js","lib/TranscriptEditor/MediaPlayer/VideoPlayer.js","lib/TranscriptEditor/MediaPlayer/VolumeControl.js","lib/TranscriptEditor/MediaPlayer/Select.js","lib/TranscriptEditor/MediaPlayer/PlayerControls.js","lib/TranscriptEditor/MediaPlayer/ProgressBar.js","lib/TranscriptEditor/MediaPlayer/defaultHotKeys.js","lib/TranscriptEditor/MediaPlayer/index.js","lib/TranscriptEditor/Settings/Toggle/index.js","lib/TranscriptEditor/Settings/TimecodeOffset/index.js","lib/TranscriptEditor/Settings/index.js","lib/TranscriptEditor/Settings/Shortcuts.js","lib/TranscriptEditor/index.js","lib/updated-react-speech-recognition/src/index.js","lib/updated-react-speech-recognition/src/SpeechRecognition.js","lib/GenerateTranscript/index.js","select-stt-json-type.js","select-export-format.js","index.js","lib/TranscriptEditor/Settings/Shortcuts.module.css","lib/TranscriptEditor/index.module.css","lib/TranscriptEditor/MediaPlayer/index.module.css","lib/TranscriptEditor/MediaPlayer/VolumeControl.module.css","lib/TranscriptEditor/Settings/TimecodeOffset/index.module.css","index.module.css","lib/TranscriptEditor/Settings/Toggle/index.module.css"],"names":["module","exports","color-light-grey","color-labs-red","bar","selectPlayerControl","settings","header","closeButton","controlsContainer","settingElement","label","rollbackValue","timecodeLabel","color-darkest-grey","playerControls","playerButton","playBackRate","timeBox","currentTime","separator","duration","color-subt-green","DraftEditor-root","editor","help","icon","helpMessage","color-mid-grey","color-dark-grey","WrapperBlock","markers","text","speaker","time","EditLabel","jumpToHere","Word","generateConfidence","data","confidence","generatePreviousTimes","prevTimes","i","start","concat","dec","Math","floor","this","props","block","getData","words","Map","isMap","toJSON","wordsData","react_default","a","createElement","style","display","data-start","data-end","end","data-confidence","data-prev-times","data-entity-key","data-block-key","getKey","className","children","PureComponent","SpeakerLabel","onClick","handleOnClickEdit","index_es","faUserEdit","name","secondsToTimecode","seconds","framePerSeconds","fps","undefined","normalisedSeconds","Number","toPrecision","toFixed","normalisePlayerTime","wholeSeconds","frames","_padZero","n","parseInt","timecodeToSecondsHelper","tc","s","split","timecodeToFrames","isOneDigit","str","length","padTimeToTimecode","timecode","includes","includesFullStop","replace","timecodeToSeconds","resultPadded","parseFloat","numberMap","១","២","៣","៤","៥","៦","៧","៨","៩","០","convertToArabicNumbers","num","String","keys","Object","key","RegExp","window","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","newSpeakerName","prompt","setState","blockProps","handleAnalyticsEvents","category","action","value","keyForCurrentCurrentBlock","currentBlockSelection","SelectionState","createEmpty","currentBlockSelectionState","EditorState","acceptSelection","editorState","getSelection","newBlockDataWithSpeakerName","newContentState","Modifier","mergeBlockData","contentState","setEditorNewContentState","getPrevStartTime","prevBlock","getBlockBefore","prevBlockStart","get","getEndTime","nextBlock","getBlockAfter","nextBlockStart","handleTimecodeClick","wasPlaying","isPlaying","togglePlayMedia","interval","setInterval","clearInterval","currentBlockTime","currentVideoTime","newStartTime","NaN","endTime","isNaN","alert","List","isList","console","log","newBlockData","newerEditorState","previousBlock","previousBlockSelection","prevBlockSelectionState","prevWordsData","newPrevBlockData","newPrevBlockContentState","getCurrentContent","error","doIt","handleJumpToHereClick","e","preventDefault","onJumpToHereClick","state","timecodeOffset","startTimecode","speakerElement","TimedTextEditor_SpeakerLabel","timecodeElement","slice","showSpeakers","faMapMarker","onMouseDown","showTimecodes","TimedTextEditor_Word","Draft","React","Component","bbcKaldiToDraft","bbcKaldiJson","results","paragraph","forEach","word","push","punct","groupWordsInParagraphs","retval","draftJsContentBlockParagraph","join","type","generateEntitiesRanges","wordAttributeName","position","map","result","offset","random","toString","substring","autoEdit2ToDraft","autoEdit2Json","autoEditText","autoEditparagraph","autoEditLine","line","tmpWord","startTime","test","entityRanges","getSpeaker","speakers","speakerIdx","speechmaticsToDraft","speechmaticsJson","tmpWords","tmpSpeakers","curatedWords","curatePunctuation","element","index","toLowerCase","paragraphStart","sttJsonAdapter","transcriptData","sttJsonType","blocks","entityMap","txt","blockData","x","exportAdapter","exportFormat","JSON","stringify","ext","draftToTxt","TimedTextEditor","KeyBindingUtil","hasCommandModifier","onChange","isPauseWhileTypingOn","playMedia","isEditable","saveTimer","clearTimeout","setTimeout","localSave","mediaUrl","handleDoubleClick","event","nativeEvent","target","hasAttribute","parentElement","t","getAttribute","onWordClick","mediaUrlName","fileName","convertToRaw","localStorage","setItem","newLastLocalSavedDate","Date","getWordCount","wordArray","getPlainText","trim","match","setEditorContentState","convertFromRaw","createWithContent","forceRenderDecorator","newState","newEditorState","customKeyBindingFn","keyCode","altKey","getDefaultKeyBinding","handleKeyCommand","command","splitParagraph","currentSelection","isCollapsed","currentContent","splitBlock","splitState","targetSelection","originalBlock","blockMap","selectionBefore","getStartKey","originalBlockData","blockSpeaker","wordStartTime","wordsDataForNew","fromJS","newBlock","setIn","getText","afterMergeContentState","newestEditorState","wordsDataForOld","wordsLeft","afterMergeContentState2","updateTimecode","renderBlockWithTimecodes","component","editable","settingTimecodeFor","copyCurrentTimeToClipboard","navigator","clipboard","writeText","then","err","getCurrentWord","checkToScroll","arguments","currentWord","nextWord","next","isScrollIntoViewOn","thisWordElement","document","querySelector","nextWordElement","scrollIntoView","inline","loadData","prevProps","prevState","isPresentInLocalStorage","format","getItem","parse","lastLocalSavedDate","_this2","faMousePointer","faICursor","faKeyboard","faSave","tooltip","es","content","fadeDuration","fadeEasing","placement","radius","faQuestionCircle","round","onDoubleClick","scoped","stripPastedStyles","blockRendererFn","keyBindingFn","faShareSquare","cursor","nextProps","VideoPlayer","id","playsInline","src","onTimeUpdate","data-testid","onLoadedData","onLoadedDataGetDuration","ref","videoRef","VolumeControl","styles","switchContainer","switch","defaultChecked","handleMuteVolume","slider","Select","options","option","currentValue","handleChange","PlayerControls","setIntervalHelperBackward","skipBackward","clearIntervalHelper","setIntervalHelperForward","skipForward","title","rollback","faUndo","onMouseUp","faBackward","faPause","faPlay","faForward","MediaPlayer_Select","playbackRateOptions","playbackRate","setPlayBackRate","promptSetCurrentTime","handleSaveTranscript","pictureInPicture","faTv","MediaPlayer_VolumeControl","ProgressBar","progress","buttonClick","min","max","returnHotKeys","self","alt+k","priority","handler","displayKeyCombination","alt+l","alt+-","decreasePlaybackRate","alt+=","increasePlaybackRate","alt+u","jumpToStartOfBlock","alt+j","rollBack","alt+t","PLAYBACK_RATES","MediaPlayer","hot_keys","assertThisInitialized","setCurrentTime","newCurrentTime","newCurrentTimeInSeconds","current","readyState","userTimecodeValue","setTimeCodeOffset","newTimeCodeOffSet","rollBackValueInSeconds","tmpDesiredCurrentTime","timedTextEditorRef","handleTimeUpdate","hookOnTimeUpdate","handlePlayBackRateChange","input","slower","reverse","find","newSpeed","faster","handleChangeReplayRollbackValue","volume","paused","pauseMedia","pause","play","bool","handleProgressBarClick","getMediaCurrentTime","handleMediaDurationChange","currentDuration","currentDurationWithOffset","durationInSeconds","mediaDuration","defaultStartTime","handlePictureInPicture","pictureInPictureElement","exitPictureInPicture","catch","requestPictureInPicture","createRef","hotKeys","hookSeek","hookPlayMedia","hookIsPlaying","playingWhileListening","player","MediaPlayer_VideoPlayer","bind","playerControlsSection","controlsSection","titleBox","MediaPlayer_PlayerControls","onSetCurrentTime","onSetTimecodeOffset","progressBar","MediaPlayer_ProgressBar","topSection","playerSection","hotkeys","Toggle","defaultValue","handleToggle","TimecodeOffset","resetTimecodeOffset","handleSetTimecodeOffset","setTimecodeOffset","offsetContainer","inputBox","button","Settings","handleSettingsToggle","faWindowClose","Settings_Toggle","defaultValuePauseWhileTyping","handlePauseWhileTyping","defaultValueScrollSync","handleIsScrollIntoViewChange","defaultRollBackValueInSeconds","handleRollBackValueInSeconds","handleShowTimecodes","handleShowSpeakers","Settings_TimecodeOffset","Shortcuts","hotKeysCheatsheet","shortcut","listItem","shortcutLabel","shortcuts","handleShortcutsToggle","list","urlParams","URLSearchParams","location","search","TranscriptEditor","ifPresentRetrieveTranscriptFromLocalStorage","info","loadLocalSavedData","handleWordClick","handlePlayMedia","handleIsPlaying","isChecked","checked","rollBackValue","forceUpdate","showSettings","showShortcuts","getEditorContent","has","lastLocalSavedTime","mediaPlayer","TranscriptEditor_MediaPlayer","foo","TranscriptEditor_Settings","Settings_Shortcuts","timedTextEditor","TranscriptEditor_TimedTextEditor","container","aside","settingsContainer","settingsButton","faCog","main","SpeechRecognition","SpeechRecognitionInner","WrappedComponent","listening","BrowserSpeechRecognition","webkitSpeechRecognition","mozSpeechRecognition","msSpeechRecognition","oSpeechRecognition","recognition","browserSupportsSpeechRecognition","autoStart","pauseAfterDisconnect","interimTranscript","finalTranscript","newTranscriptData","status","wonid","_Component","SpeechRecognitionContainer","minElapsed","now","speechTimerStartedAt","newWordData","wordResults","transcript","allWordData","onRecognitionDisconnect","startListening","updateTranscript","allResults","resultIndex","isFinal","concatTranscripts","resetTranscript","disconnect","DOMException","abortListening","stopListening","inherits","createClass","continuous","interimResults","onresult","onend","disconnectType","abort","stop","_len","transcriptParts","Array","_key","totalTimeElapsed","assign","GenerateTranscript","reset","generateJSON","lang","transcriptJSON","filename","prettyData","download","_this$props","height","overflowY","SttTypeSelect","disabled","ExportFormatSelect","App","handleIsTextEditable","isTextEditable","handleSttTypeChange","defineProperty","handleExportFormatChange","exportTranscript","_this$transcriptEdito","transcriptEditorRef","contentType","blob","Blob","href","URL","createObjectURL","click","clearLocalStorage","clear","analyticsEvents","toConsumableArray","handleChangeTranscriptName","sttType","startListeningAndPlayingMedia","hunSenInterviewPart1Transcript","files","file","canPlayType","fileURL","fr","FileReader","onload","evt","readAsText","_this3","rel","lib_GenerateTranscript","loadDemo","handleChangeLoadMedia","handleChangeLoadMediaUrl","select_stt_json_type","handleChangeLoadTranscriptJson","select_export_format","lib_TranscriptEditor","render","src_App","getElementById","color-lightest-grey","helpText","hideInMobile"],"mappings":"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","file":"static/js/main.b2d71a84.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-light-grey\":\"#767676\",\"color-labs-red\":\"#a0372d\",\"bar\":\"ProgressBar_bar__3lESu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"selectPlayerControl\":\"Select_selectPlayerControl__K8I2_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"settings\":\"Settings_settings__131gP\",\"header\":\"Settings_header__3gK1h\",\"closeButton\":\"Settings_closeButton__wD_fB\",\"controlsContainer\":\"Settings_controlsContainer__j6tEh\",\"settingElement\":\"Settings_settingElement__ErFP7\",\"label\":\"Settings_label__3QTmN\",\"rollbackValue\":\"Settings_rollbackValue__1OTsV\",\"timecodeLabel\":\"Settings_timecodeLabel__1LKIL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-darkest-grey\":\"#282828\",\"color-light-grey\":\"#767676\",\"color-labs-red\":\"#a0372d\",\"playerControls\":\"PlayerControls_playerControls__17zIK\",\"playerButton\":\"PlayerControls_playerButton__1zxDP\",\"playBackRate\":\"PlayerControls_playBackRate__3b9Gj\",\"timeBox\":\"PlayerControls_timeBox__3gHFS\",\"currentTime\":\"PlayerControls_currentTime__16CX-\",\"separator\":\"PlayerControls_separator__3IO7E\",\"duration\":\"PlayerControls_duration__1r95o\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-subt-green\":\"#69e3c2\",\"color-darkest-grey\":\"#282828\",\"color-labs-red\":\"#a0372d\",\"DraftEditor-root\":\"TimedTextEditor_DraftEditor-root__bIxvS\",\"editor\":\"TimedTextEditor_editor__2Qhw9\",\"help\":\"TimedTextEditor_help__AP8BA\",\"icon\":\"TimedTextEditor_icon__1BfEt\",\"helpMessage\":\"TimedTextEditor_helpMessage__3fn_W\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-labs-red\":\"#a0372d\",\"color-light-grey\":\"#767676\",\"color-mid-grey\":\"#696969\",\"color-dark-grey\":\"#4a4a4a\",\"WrapperBlock\":\"WrapperBlock_WrapperBlock__3Ky6T\",\"markers\":\"WrapperBlock_markers__3ILw6\",\"text\":\"WrapperBlock_text__29dkP\",\"speaker\":\"WrapperBlock_speaker__3hDu5\",\"time\":\"WrapperBlock_time__7MR_0\",\"EditLabel\":\"WrapperBlock_EditLabel__3srCB\",\"jumpToHere\":\"WrapperBlock_jumpToHere__14vpQ\"};","import React, { PureComponent } from 'react';\nimport { Map, List, fromJS } from 'immutable'\nimport PropTypes from 'prop-types';\n\nclass Word extends PureComponent {\n  generateConfidence = (data) => {\n    // handling edge case where confidence score not present\n    if (data.confidence) {\n      return data.confidence > 0.6 ? 'high' : 'low';\n    }\n\n    return 'high';\n  }\n\n  generatePreviousTimes = (data) => {\n    let prevTimes = '';\n\n    for (let i = 0; i < data.start; i++) {\n      prevTimes += `${ i } `;\n    }\n\n    if (data.start % 1 > 0) {\n      // Find the closest quarter-second to the current time, for more dynamic results\n      const dec = Math.floor((data.start % 1) * 4.0) / 4.0;\n      prevTimes += ` ${ Math.floor(data.start) + dec }`;\n    }\n\n    return prevTimes;\n  }\n\n  render() {\n    // including a lot of catchers since there always seems to be an empty block with no text and data sneaking in here\n    let data = this.props.block && this.props.block.getData() || { words: [ {} ] }\n    if (Map.isMap(data)) {\n      data = data.toJSON()\n    }\n    let wordsData = data.words || {}\n    wordsData = wordsData[0] ? wordsData[0] : {}\n\n\n    return (\n      <div\n        style={ {\n          display: 'inline-block',\n        } }\n        data-start={ wordsData.start }\n        data-end={ wordsData.end }\n        data-confidence = { this.generateConfidence(wordsData) }\n        data-prev-times = { this.generatePreviousTimes(wordsData) }\n        data-entity-key={ '' }\n        data-block-key={ this.props.block.getKey() }\n        className=\"Word\">\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nWord.propTypes = {\n  contentState: PropTypes.object,\n  //entityKey: PropTypes.string,\n  block: PropTypes.object,\n  // children: PropTypes.array\n};\n\nexport default Word;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUserEdit } from '@fortawesome/free-solid-svg-icons';\n\nimport style from './WrapperBlock.module.css';\n\nclass SpeakerLabel extends PureComponent {\n  render() {\n    return (\n      <span className={ style.speaker }>\n        <span\n          className={ style.EditLabel }\n          onClick={ this.props.handleOnClickEdit }>\n          <FontAwesomeIcon icon={ faUserEdit } />\n        </span>\n        {this.props.name}\n      </span>\n    );\n  }\n}\n\nSpeakerLabel.propTypes = {\n  name: PropTypes.string,\n  handleOnClickEdit: PropTypes.func\n};\n\nexport default SpeakerLabel;\n","/**\n* Raised in this comment https://github.com/bbc/react-transcript-editor/pull/9\n* abstracted from https://github.com/bbc/newslabs-cdn/blob/master/js/20-bbcnpf.utils.js\n* In broadcast VIDEO, timecode is NOT hh:mm:ss:ms, it's hh:mm:ss:ff where ff is frames,\n* dependent on the framerate of the media concerned.\n* `hh:mm:ss:ff`\n*/\n\n/**\n * Helper function\n * Rounds to the 14milliseconds boundaries\n * Time in video can only \"exist in\" 14milliseconds boundaries.\n * This makes it possible for the HTML5 player to be frame accurate.\n * @param {*} seconds\n * @param {*} fps\n */\nconst normalisePlayerTime = function (seconds, fps) {\n  return Number((1.0 / fps * Math.floor(Number((fps * seconds).toPrecision(12)))).toFixed(2));\n};\n\n/*\n* @param {*} seconds\n* @param {*} fps\n*/\nconst secondsToTimecode = function (seconds, framePerSeconds) {\n  // written for PAL non-drop timecode\n  let fps = 25;\n  if (framePerSeconds !== undefined) {\n    fps = framePerSeconds;\n  }\n\n  const normalisedSeconds = normalisePlayerTime(seconds, fps);\n\n  const wholeSeconds = Math.floor(normalisedSeconds);\n  const frames = ((normalisedSeconds - wholeSeconds) * fps).toFixed(2);\n\n  // prepends zero - example pads 3 to 03\n  function _padZero(n) {\n    if (n < 10) return `0${ parseInt(n) }`;\n\n    return parseInt(n);\n  }\n\n  return `${ _padZero((wholeSeconds / 60 / 60) % 60)\n  }:${\n    _padZero((wholeSeconds / 60) % 60)\n  }:${\n    _padZero(wholeSeconds % 60)\n  }:${\n    _padZero(frames) }`;\n};\n\nexport default secondsToTimecode;\n","/**\n * Helperf unction\n * @param {*} tc\n * @param {*} fps\n */\nconst timecodeToFrames = function (tc, fps) {\n  // TODO make 29.97 fps drop-frame aware - works for 25 only.\n\n  const s = tc.split(':');\n  let frames = parseInt(s[3]);\n  frames += parseInt(s[2]) * fps;\n  frames += parseInt(s[1]) * (fps * 60);\n  frames += parseInt(s[0]) * (fps * 60 * 60);\n\n  return frames;\n};\n\n/**\n * Convert broadcast timecodes to seconds\n * @param {*} tc - `hh:mm:ss:ff`\n * @param {*} framePerSeconds - defaults to 25 if not provided\n */\nconst timecodeToSecondsHelper = function (tc, framePerSeconds) {\n  let fps = 25;\n  if (framePerSeconds !== undefined) {\n    fps = framePerSeconds;\n  }\n  const frames = timecodeToFrames(tc, fps);\n\n  return Number(Number(frames / fps).toFixed(2));\n};\n\nexport default timecodeToSecondsHelper;\n","const countColon = timecode => timecode.split(':').length;\n\nconst includesFullStop = timecode => timecode.includes('.');\n\nconst isOneDigit = str => str.length === 1;\n\nconst padTimeToTimecode = (time) => {\n  if (typeof time === 'string') {\n    switch (countColon(time)) {\n    case 4:\n      // is already in timecode format\n      // hh:mm:ss:ff\n      return time;\n    case 2:\n      // m:ss\n      if (isOneDigit(time.split(':')[0])) {\n        return `00:0${ time }:00`;\n      }\n\n      return `00:${ time }:00`;\n    case 3:\n      // hh:mm:ss\n      return `${ time }:00`;\n    default:\n      // mm.ss\n      if (includesFullStop(time)) {\n        // m.ss\n        if (isOneDigit(time.split('.')[0])) {\n          return `00:0${ time.split('.')[0] }:${ time.split('.')[1] }:00`;\n        }\n\n        return `00:${ time.replace('.', ':') }:00`;\n      }\n\n      // if just int, then it's seconds\n      // s\n      if (isOneDigit(time)) {\n        return `00:00:0${ time }:00`;\n      }\n\n      return `00:00:${ time }:00`;\n    }\n    // edge case if it's number return a number coz cannot refactor\n    // TODO: might need to refactor and move this elsewhere\n  } else {\n    return time;\n  }\n};\n\nexport default padTimeToTimecode;\n","/**\n * Wrapping around \"time stamps\" and timecode conversion modules\n * To provide more support for variety of formats.\n */\nimport secondsToTimecode from './secondsToTimecode';\nimport timecodeToSecondsHelper from './timecodeToSeconds';\nimport padTimeToTimecode from './padTimeToTimecode';\n\n/**\n * @param {*} time\n * Can take as input timecodes in the following formats\n * - hh:mm:ss:ff\n * - mm:ss\n * - m:ss\n * - ss - seconds --> if it's already in seconds then it just returns seconds\n * - hh:mm:ff\n * @todo could be refactored with some helper functions for clarity\n */\nconst timecodeToSeconds = (time) => {\n  if (typeof time === 'string') {\n    const resultPadded = padTimeToTimecode(time);\n    const resultConverted = timecodeToSecondsHelper(resultPadded);\n\n    return resultConverted;\n  }\n\n  // assuming it receive timecode as seconds as string '600'\n  return parseFloat(time);\n};\n\nconst shortTimecode = (time) => {\n  const timecode = secondsToTimecode(time);\n\n  return timecode.slice(0, -3);\n};\n\nexport { secondsToTimecode, timecodeToSeconds, shortTimecode };\n","/**\n */\n\n/**\n * @param {*} time string potentially with khmer numbers\n */\nconst numberMap = {\n  '១': 1,\n  '២': 2,\n  '៣': 3,\n  '៤': 4,\n  '៥': 5,\n  '៦': 6,\n  '៧': 7,\n  '៨': 8,\n  '៩': 9,\n  '០': 0\n}\n\n// quick and dirty solution, though probably not as fast as char codes or whatever\nconst convertToArabicNumbers = (num) => {\n  let str = num\n  if (typeof str !== 'string') {\n    str = String(str)\n  }\n  const keys = Object.keys(numberMap)\n  for (var i = 0; i < keys.length; i ++) {\n    let key = keys[i]\n    str = str.replace(new RegExp(key, \"g\"), numberMap[key])\n  }\n\n\n  return str\n};\n\nexport { convertToArabicNumbers };\n","import React from 'react';\nimport { EditorBlock, Modifier, EditorState, SelectionState } from 'draft-js';\n\nimport SpeakerLabel from './SpeakerLabel';\nimport Word from './Word';\nimport { shortTimecode, secondsToTimecode, timecodeToSeconds } from '../../Util/timecode-converter/';\nimport { convertToArabicNumbers } from '../../Util/khmer-numbers/';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMapMarker } from '@fortawesome/free-solid-svg-icons';\n\nimport style from './WrapperBlock.module.css';\nimport { Map, List, fromJS } from 'immutable'\n\nwindow.convertToArabicNumbers = convertToArabicNumbers\nclass WrapperBlock extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      speaker: '',\n      start: 0, // time in seconds from start of media\n      timecodeOffset: this.props.blockProps.timecodeOffset\n    };\n  }\n\n  componentDidMount() {\n    const { block } = this.props;\n    const speaker = block.getData().get('speaker');\n\n    const start = block.getData().get('start');\n\n    this.setState({\n      speaker: speaker,\n      start: start,\n    });\n  }\n\n  handleOnClickEdit = () => {\n    const newSpeakerName = prompt('New Speaker Name?');\n\n    if (newSpeakerName !== '' && newSpeakerName !== null) {\n      this.setState({ speaker: newSpeakerName });\n      if (this.props.blockProps.handleAnalyticsEvents !== undefined) {\n        this.props.blockProps.handleAnalyticsEvents({\n          category: 'WrapperBlock',\n          action: 'handleOnClickEdit',\n          name: 'newSpeakerName',\n          value: newSpeakerName\n        });\n      }\n\n      // From docs: https://draftjs.org/docs/api-reference-selection-state#keys-and-offsets\n      // selection points are tracked as key/offset pairs,\n      // where the key value is the key of the ContentBlock where the point is positioned\n      // and the offset value is the character offset within the block.\n\n      // Get key of the currentBlock\n      const keyForCurrentCurrentBlock = this.props.block.getKey();\n      // create empty selection for current block\n      // https://draftjs.org/docs/api-reference-selection-state#createempty\n      const currentBlockSelection = SelectionState.createEmpty(keyForCurrentCurrentBlock);\n      const editorStateWithSelectedCurrentBlock = EditorState.acceptSelection(this.props.blockProps.editorState, currentBlockSelection);\n\n      const currentBlockSelectionState = editorStateWithSelectedCurrentBlock.getSelection();\n      const newBlockDataWithSpeakerName = { speaker: newSpeakerName };\n\n      // https://draftjs.org/docs/api-reference-modifier#mergeblockdata\n      const newContentState = Modifier.mergeBlockData(\n        this.props.contentState,\n        currentBlockSelectionState,\n        newBlockDataWithSpeakerName\n      );\n\n      this.props.blockProps.setEditorNewContentState(newContentState);\n    }\n  }\n\n  getPrevStartTime = () => {\n    const keyForCurrentCurrentBlock = this.props.block.getKey();\n    const prevBlock = this.props.contentState.getBlockBefore(keyForCurrentCurrentBlock); \n    // won't be a prev block if it's the first block!\n    const prevBlockStart = prevBlock ? prevBlock.getData().get('start') : 0;\n\n    return parseFloat(prevBlockStart)\n  }\n\n  getEndTime = () => {\n    const keyForCurrentCurrentBlock = this.props.block.getKey();\n    const nextBlock = this.props.contentState.getBlockAfter(keyForCurrentCurrentBlock); \n    // won't be a next block if it's the last block, so setting really high number\n    const nextBlockStart = nextBlock ? nextBlock.getData().get('start') : 9*999*999*999;\n\n    return parseFloat(nextBlockStart)\n  }\n\n  // changes the timeblock's timing\n  handleTimecodeClick = () => {\n    let wasPlaying = this.props.blockProps.isPlaying();\n    this.props.blockProps.togglePlayMedia(false);\n\n    // does the whole thing after making sure it's really paused\n    const doIt = () => {\n      const currentBlockTime = secondsToTimecode(this.props.block.getData().get('start'));\n      // TODO not accurate; bad practice, but fastest quick fix would be to use js to just grab the element of the video player and grab the text \n      const currentVideoTime = secondsToTimecode(this.props.blockProps.currentTime);\n      let newStartTime = prompt(`Edit Time - hh:mm:ss:ff hh:mm:ss mm:ss m:ss m.ss seconds (originally at ${ currentBlockTime })`, currentVideoTime);\n\n      if (newStartTime !== '' && newStartTime !== null && parseInt(newStartTime) !== NaN) {\n        // in case of khmer numbers getting thrown in there\n        newStartTime = convertToArabicNumbers(newStartTime)\n\n        if (newStartTime.includes(':')) {\n          newStartTime = timecodeToSeconds(newStartTime)\n        }\n        newStartTime = parseFloat(newStartTime)\n\n        // make them put in new time or just cancel if start time is after end time\n        let endTime = this.getEndTime()\n        if (!isNaN(newStartTime) && !isNaN(endTime) && newStartTime >= endTime) {\n          alert(\"Start Time must be before next block's start time\")\n\n          return\n        } else if (!isNaN(newStartTime) && !isNaN(endTime) && newStartTime <= this.getPrevStartTime()) {\n          alert(\"Start Time must be after previous block's start time\")\n\n          return\n        }\n\n        this.setState({ start: newStartTime });\n\n        // Get key of the currentBlock\n        const keyForCurrentCurrentBlock = this.props.block.getKey();\n\n        // create empty selection for current block\n        // https://draftjs.org/docs/api-reference-selection-state#createempty\n        const currentBlockSelection = SelectionState.createEmpty(keyForCurrentCurrentBlock);\n        const editorStateWithSelectedCurrentBlock = EditorState.acceptSelection(this.props.blockProps.editorState, currentBlockSelection);\n\n        const currentBlockSelectionState = editorStateWithSelectedCurrentBlock.getSelection();\n\n        let wordsData = this.props.block.getData().get('words') || [ {} ]; // really should just break...being too flexible here...\n        // if (!List.isList(wordsData) || !Map.isMap(wordsData)) {\n        if (List.isList(wordsData)) {\n          console.log(\"words data was a list\");\n          wordsData = wordsData.toJSON();\n        }\n        // wordsData = wordsData.setIn([ 0, 'start' ], newStartTime)\n        console.log(\"words data\", wordsData);\n        console.log(\"block\", this.props.block);\n        wordsData[0].start = newStartTime;\n\n        const newBlockData = {\n          start: newStartTime,\n          words: wordsData,\n        };\n\n        // https://draftjs.org/docs/api-reference-modifier#mergeblockdata\n        const newContentState = Modifier.mergeBlockData(\n          this.props.contentState,\n          currentBlockSelectionState,\n          newBlockData\n        );\n\n        const newerEditorState = this.props.blockProps.setEditorNewContentState(newContentState);\n\n        //////////////////////////////////////////////////////\n        // set end time of previous block to this start time TODO (though if never use end time in app, might not be necessary\n        const previousBlock = this.props.contentState.getBlockBefore(keyForCurrentCurrentBlock);\n        // won't be a prev block if it's the first block\n        if (previousBlock) {\n          const previousBlockSelection = SelectionState.createEmpty(previousBlock.getKey());\n          const editorStateWithSelectedPrevBlock = EditorState.acceptSelection(this.props.blockProps.editorState, previousBlockSelection);\n\n          const prevBlockSelectionState = editorStateWithSelectedPrevBlock.getSelection();\n          let prevWordsData = previousBlock.getData().get('words') || [ {} ]// really should just break...being too flexible here...\n          // draft js will turn into immutable anyways, so might as well beat them to the punch\n          // if (!List.isList(prevWordsData) || !Map.isMap(prevWordsData)) {\n          if (List.isList(prevWordsData)) {\n            prevWordsData = prevWordsData.toJSON()\n          }\n          // This part might not be necessary if the previous thing works right. TODO  but better safe than sorry in the meantime, minor performance issue\n          if (Map.isMap(prevWordsData[0])) {\n            prevWordsData[0] = prevWordsData[0].toJSON()\n          }\n          // prevWordsData = prevWordsData.setIn([ 0, 'end' ], newStartTime)\n          prevWordsData[0].end = newStartTime\n\n          const newPrevBlockData = {\n            words: prevWordsData,\n          };\n\n          // https://draftjs.org/docs/api-reference-modifier#mergeblockdata\n          const newPrevBlockContentState = Modifier.mergeBlockData(\n            newerEditorState.getCurrentContent(),\n            prevBlockSelectionState,\n            newPrevBlockData\n          );\n\n          this.props.blockProps.setEditorNewContentState(newPrevBlockContentState);\n        }\n      } else {\n        console.error(\"What went wrong setting timeblock time?\", newStartTime)\n      }\n      if (wasPlaying) {\n        this.props.blockProps.togglePlayMedia(true)\n      }\n    }\n\n    // this is so bad...but so is using prompt ha\n    // makes sure that the video stops, because if prompt opens before it stops, it keeps playign\n    const interval = setInterval(() => {\n      if (!this.props.blockProps.isPlaying()) {\n        clearInterval(interval)\n        doIt();\n      }\n    }, 20)\n\n  }\n\n  handleJumpToHereClick = (e) => {\n    // https://github.com/facebook/draft-js/issues/696#issuecomment-302903086\n    e.preventDefault() // prevents cursor from moving away\n    this.props.blockProps.onJumpToHereClick(this.state.start);\n  }\n\n  render() {\n    let startTimecode = this.state.start;\n    const { blockProps } = this.props\n    if (blockProps.timecodeOffset) {\n      startTimecode += this.props.blockProps.timecodeOffset;\n    }\n\n    const speakerElement = <SpeakerLabel\n      name={ this.state.speaker }\n      handleOnClickEdit={ this.handleOnClickEdit }\n    />;\n\n    const timecodeElement = <span className={ style.time } onClick={ this.handleTimecodeClick }>{shortTimecode(startTimecode)}</span>;\n\n    return (\n      <div className={ style.WrapperBlock }>\n        <div className={ style.markers }>\n          {blockProps.showSpeakers ? speakerElement : ''}\n          <FontAwesomeIcon icon={ faMapMarker } onMouseDown={ this.handleJumpToHereClick } className= { style.jumpToHere }/>\n          {blockProps.showTimecodes ? timecodeElement : ''}\n        </div>\n        <div className={ style.text }>\n          <Word block={ this.props.block }>\n            <EditorBlock { ...this.props } />\n          </Word>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WrapperBlock;\n","/**\n * Convert BBC Kaldi json\n ```\n {\n    \"action\": \"audio-transcribe\",\n    \"retval\": {\n      \"status\": true,\n      \"wonid\": \"octo:2692ea33-d595-41d8-bfd5-aa7f2d2f89ee\",\n      \"punct\": \"There is a day. About ten years ago when  ...\",\n      \"words\": [\n        {\n          \"start\": 13.02,\n          \"confidence\": 0.68,\n          \"end\": 13.17,\n          \"word\": \"there\",\n          \"punct\": \"There\",\n          \"index\": 0\n        },\n        {\n          \"start\": 13.17,\n          \"confidence\": 0.61,\n          \"end\": 13.38,\n          \"word\": \"is\",\n          \"punct\": \"is\",\n          \"index\": 1\n        },\n        ...\n```\n *\n * into\n *\n ```\n const blocks = [\n  {\n    \"text\": \"There is a day.\",\n    \"type\": \"paragraph\",\n    \"data\": {\n      \"speaker\": \"TBC 0\",\n      \"words\": [\n        {\n          \"start\": 13.02,\n          \"confidence\": 0.68,\n          \"end\": 13.17,\n          \"word\": \"there\",\n          \"punct\": \"There\",\n          \"index\": 0\n        },\n        {\n          \"start\": 13.17,\n          \"confidence\": 0.61,\n          \"end\": 13.38,\n          \"word\": \"is\",\n          \"punct\": \"is\",\n          \"index\": 1\n        },\n        {\n          \"start\": 13.38,\n          \"confidence\": 0.99,\n          \"end\": 13.44,\n          \"word\": \"a\",\n          \"punct\": \"a\",\n          \"index\": 2\n        },\n        {\n          \"start\": 13.44,\n          \"confidence\": 1,\n          \"end\": 13.86,\n          \"word\": \"day\",\n          \"punct\": \"day.\",\n          \"index\": 3\n        }\n      ],\n      \"start\": 13.02\n    },\n    \"entityRanges\": [\n      {\n        \"start\": 13.02,\n        \"end\": 13.17,\n        \"confidence\": 0.68,\n        \"text\": \"There\",\n        \"offset\": 0,\n        \"length\": 5,\n        \"key\": \"li6c6ld\"\n      },\n      {\n        \"start\": 13.17,\n        \"end\": 13.38,\n        \"confidence\": 0.61,\n        \"text\": \"is\",\n        \"offset\": 6,\n        \"length\": 2,\n        \"key\": \"pcgzkp6\"\n      },\n      {\n        \"start\": 13.38,\n        \"end\": 13.44,\n        \"confidence\": 0.99,\n        \"text\": \"a\",\n        \"offset\": 9,\n        \"length\": 1,\n        \"key\": \"ngomd9\"\n      },\n      {\n        \"start\": 13.44,\n        \"end\": 13.86,\n        \"confidence\": 1,\n        \"text\": \"day.\",\n        \"offset\": 11,\n        \"length\": 4,\n        \"key\": \"sgmfl4f\"\n      }\n    ]\n  },\n  ...\n```\n *\n */\n\n// import generateEntitiesRanges from '../generate-entities-ranges/index.js';\n\n/**\n * groups words list from kaldi transcript based on punctuation.\n * @todo To be more accurate, should introduce an honorifics library to do the splitting of the words.\n * @param {array} words - array of words opbjects from kaldi transcript\n */\n\nconst groupWordsInParagraphs = (words) => {\n  const results = [];\n  let paragraph = { words: [], text: [] };\n\n  // for us, until can figure out a way to go from speech recognition to punctuation, so can divide up speech blocks, with Khmer just want to make each word a paragraph, since that's kind of what ends up happening.\n  words.forEach((word) => {\n    // if word contains punctuation TODO add Khmer punctuation. Right now, will always return false\n    if (true || /[.?!\\s]/.test(word.punct)) {\n      paragraph.words.push(word);\n      paragraph.text.push(word.punct);\n      results.push(paragraph);\n      // reset paragraph\n      paragraph = { words: [], text: [] };\n    } else {\n\n      paragraph.words.push(word);\n      paragraph.text.push(word.punct);\n    }\n  });\n  // RQ added. If we don't add this though, I think it ends up skipping the last paragraph...or for Khmer, maybe the whole transcript!\n  results.push(paragraph);\n\n  return results;\n};\n\nconst bbcKaldiToDraft = (bbcKaldiJson) => {\n  const results = [];\n  let tmpWords;\n\n  // BBC Octo Labs API Response wraps Kaldi response around retval,\n  // while kaldi contains word attribute at root\n  if (bbcKaldiJson.retval !== undefined) {\n    tmpWords = bbcKaldiJson.retval.words;\n  } else {\n    tmpWords = bbcKaldiJson.words;\n  }\n\n  const wordsByParagraphs = groupWordsInParagraphs(tmpWords);\n\n  wordsByParagraphs.forEach((paragraph, i) => {\n    if (!paragraph.words.length) {\n      return\n    }\n\n    const draftJsContentBlockParagraph = {\n      text: paragraph.text.join(' '),\n      type: 'paragraph',\n      data: {\n        speaker: `TBC ${ i }`,\n        words: paragraph.words,\n        start: paragraph.words[0].start\n      },\n    };\n    // console.log(JSON.stringify(draftJsContentBlockParagraph,null,2))\n    results.push(draftJsContentBlockParagraph);\n  });\n\n  return results;\n};\n\nexport default bbcKaldiToDraft;\n","/**\n * Helper function to generate draft.js entities,\n * see unit test for example data structure\n * it adds offset and length to recognise word in draftjs\n */\n\n/**\n*  @param {json} words  - List of words\n*  @param {string} wordAttributeName - eg 'punct' or 'text' or etc.\n* attribute for the word object containing the text. eg word ={ punct:'helo', ... }\n*  or eg word ={ text:'helo', ... }\n*/\nconst generateEntitiesRanges = (words, wordAttributeName) => {\n  let position = 0;\n\n  return words.map((word) => {\n    const result = {\n      start: word.start,\n      end: word.end,\n      confidence: word.confidence,\n      text: word[wordAttributeName],\n      offset: position,\n      length: word[wordAttributeName].length,\n      key: Math.random()\n        .toString(36)\n        .substring(6),\n    };\n    // increase position counter - to determine word offset in paragraph\n    position = position + word[wordAttributeName].length + 1;\n\n    return result;\n  });\n};\n\nexport default generateEntitiesRanges;\n","/**\n * Convert autoEdit2 Json\n *\n * into\n *\n ```\n const blocks = [\n        {\n            text: 'Hello',\n            type: 'paragraph',\n            data: {\n            speaker: 'Foo',\n            },\n            entityRanges: [],\n        },\n        {\n            text: 'World',\n            type: 'paragraph',\n            data: {\n            speaker: 'Bar',\n            },\n            entityRanges: [],\n        },\n        ];\n```\n *\n * See samples folder and test file\n * for reference data structures\n */\n\nimport generateEntitiesRanges from '../generate-entities-ranges/index';\n\n/**\n * groups words list from autoEdit transcript based on punctuation.\n * @todo To be more accurate, should introduce an honorifics library to do the splitting of the words.\n * @param {array} words - array of words objects from autoEdit transcript\n */\n\nconst groupWordsInParagraphs = (autoEditText) => {\n  const results = [];\n  let paragraph = { words: [], text: [] };\n\n  autoEditText.forEach((autoEditparagraph) => {\n    autoEditparagraph.paragraph.forEach((autoEditLine) => {\n      autoEditLine.line.forEach((word) => {\n        // adjusting time reference attributes from\n        // `startTime` `endTime` to `start` `end`\n        // for word object\n        const tmpWord = {\n          text: word.text,\n          start: word.startTime,\n          end: word.endTime,\n        };\n        //  if word contains punctuation\n        if (/[.?!]/.test(word.text)) {\n          paragraph.words.push(tmpWord);\n          paragraph.text.push(word.text);\n          results.push(paragraph);\n          // reset paragraph\n          paragraph = { words: [], text: [] };\n        } else {\n          paragraph.words.push(tmpWord);\n          paragraph.text.push(word.text);\n        }\n      });\n    });\n  });\n\n  return results;\n};\n\nconst autoEdit2ToDraft = (autoEdit2Json) => {\n  const results = [];\n  const tmpWords = autoEdit2Json.text;\n  const wordsByParagraphs = groupWordsInParagraphs(tmpWords);\n\n  wordsByParagraphs.forEach((paragraph, i) => {\n    const draftJsContentBlockParagraph = {\n      text: paragraph.text.join(' '),\n      type: 'paragraph',\n      data: {\n        speaker: `TBC ${ i }`,\n        words: paragraph.words,\n        start: paragraph.words[0].start\n      },\n      // the entities as ranges are each word in the space-joined text,\n      // so it needs to be compute for each the offset from the beginning of the paragraph and the length\n      entityRanges: generateEntitiesRanges(paragraph.words, 'text'),\n    };\n    // console.log(JSON.stringify(draftJsContentBlockParagraph,null,2))\n    results.push(draftJsContentBlockParagraph);\n  });\n\n  // console.log(JSON.stringify(results,null,2))\n  return results;\n};\n\nexport default autoEdit2ToDraft;\n","/**\n *  Convert Speechmatics\n */\n\nimport generateEntitiesRanges from '../generate-entities-ranges/index.js';\n\n/**\n * groups words list from speechmatics based on punctuation.\n * @todo To be more accurate, should introduce an honorifics library to do the splitting of the words.\n * @todo As this function is also used in the bbc-kaldi adapter, should it be refactored into its own file?\n * @param {array} words - array of words objects from speechmatics transcript\n */\n\nconst groupWordsInParagraphs = (words) => {\n  const results = [];\n  let paragraph = { words: [], text: [] };\n\n  words.forEach((word) => {\n    // if word contains punctuation\n    if (/[.?!]/.test(word.punct)) {\n      paragraph.words.push(word);\n      paragraph.text.push(word.punct);\n      results.push(paragraph);\n      // reset paragraph\n      paragraph = { words: [], text: [] };\n    } else {\n      paragraph.words.push(word);\n      paragraph.text.push(word.punct);\n    }\n  });\n\n  return results;\n};\n\n/**\n * Determines the speaker of a paragraph by comparing the start time of the paragraph with\n * the speaker times.\n * @param {float} start - Starting point of paragraph\n * @param {array} speakers - list of all speakers with start and end time\n */\nconst getSpeaker = (start, speakers) => {\n  for (var speakerIdx in speakers) {\n    const speaker = speakers[speakerIdx];\n    if (start >= speaker.start & start < speaker.end) {\n      return speaker.name;\n    }\n  }\n\n  return 'UNK';\n};\n\n/**\n * Speechmatics treats punctuation as own words. This function merges punctuations with\n * the pevious word and adjusts the total duration of the word.\n * @param {array} words - array of words objects from speechmatics transcript\n */\nconst curatePunctuation = (words) => {\n  const curatedWords = [];\n  words.forEach((word) => {\n    if (/[.?!]/.test(word.name)) {\n      curatedWords[curatedWords.length-1].name = curatedWords[curatedWords.length-1].name + word.name;\n      curatedWords[curatedWords.length-1].duration = (parseFloat(curatedWords[curatedWords.length-1].duration) + parseFloat(word.duration)).toString();\n    } else {\n      curatedWords.push(word);\n    }\n  }\n  );\n\n  return curatedWords;\n};\n\nconst speechmaticsToDraft = (speechmaticsJson) => {\n  const results = [];\n\n  let tmpWords;\n  tmpWords = curatePunctuation(speechmaticsJson.words);\n  tmpWords = tmpWords.map((element, index) => {\n    return ({\n      start: element.time,\n      end: (parseFloat(element.time) + parseFloat(element.duration)).toString(),\n      confidence: element.confidence,\n      word: element.name.toLowerCase().replace(/[.?!]/g, ''),\n      punct: element.name,\n      index: index,\n    });\n  });\n\n  let tmpSpeakers;\n  tmpSpeakers = speechmaticsJson.speakers;\n  tmpSpeakers = tmpSpeakers.map((element) => {\n    return ({\n      start: element.time,\n      end: (parseFloat(element.time) + parseFloat(element.duration)).toString(),\n      name: element.name,\n    });\n  });\n\n  const wordsByParagraphs = groupWordsInParagraphs(tmpWords);\n\n  wordsByParagraphs.forEach((paragraph) => {\n    const paragraphStart = paragraph.words[0].start;\n    const draftJsContentBlockParagraph = {\n      text: paragraph.text.join(' '),\n      type: 'paragraph',\n      data: {\n        speaker: getSpeaker(paragraphStart, tmpSpeakers),\n        words: paragraph.words,\n        start: paragraphStart\n      },\n      // the entities as ranges are each word in the space-joined text,\n      // so it needs to be compute for each the offset from the beginning of the paragraph and the length\n      entityRanges: generateEntitiesRanges(paragraph.words, 'punct'), // wordAttributeName\n    };\n    results.push(draftJsContentBlockParagraph);\n  });\n\n  return results;\n};\n\nexport default speechmaticsToDraft;\n","import bbcKaldiToDraft from './bbc-kaldi/index';\nimport autoEdit2ToDraft from './autoEdit2/index';\nimport speechmaticsToDraft from './speechmatics/index';\n/**\n * Adapters for STT conversion\n * @param {json} transcriptData - A json transcript with some word accurate timecode\n * @param {string} sttJsonType - the type of transcript supported by the available adapters\n */\n\n// converts nested arrays into one dimensional array\nconst flatten = list => list.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), []);\n\n/*\nconst createEntityMap = (blocks) => {\n  const entityRanges = blocks.map(block => block.entityRanges);\n  // eslint-disable-next-line no-use-before-define\n  const flatEntityRanges = flatten(entityRanges);\n\n  const entityMap = {};\n\n  flatEntityRanges.forEach((data) => {\n    entityMap[data.key] = {\n      type: 'WORD',\n      mutability: 'MUTABLE',\n      data,\n    };\n  });\n\n  return entityMap;\n};\n*/\n\nconst sttJsonAdapter = (transcriptData, sttJsonType) => {\n  let blocks;\n  switch (sttJsonType) {\n  case 'bbckaldi':\n    blocks = bbcKaldiToDraft(transcriptData);\n\n    return { blocks, entityMap: {} }; //createEntityMap(blocks) };\n  case 'autoedit2':\n    blocks = autoEdit2ToDraft(transcriptData);\n\n    return { blocks, entityMap: {} }; // createEntityMap(blocks) };\n  case 'speechmatics':\n    blocks = speechmaticsToDraft(transcriptData);\n\n    return { blocks, entityMap: {} }; //  createEntityMap(blocks) };\n  case 'draftjs':\n    return transcriptData; // (typeof transcriptData === 'string')? JSON.parse(transcriptData): transcriptData;\n  default:\n    // code block\n    console.error('not recognised the stt enginge');\n  }\n};\n\nexport default sttJsonAdapter;\n","export default (blockData) => {\n  const lines = blockData.blocks.map(x => x.text);\n\n  return lines.join('\\n\\n');\n};\n","import draftToTxt from './txt/index';\n/**\n * Adapters for Draft.js conversion\n * @param {json} blockData - Draft.js blocks\n * @param {string} exportFormat - the type of file supported by the available adapters\n */\n\nconst exportAdapter = (blockData, exportFormat) => {\n  switch (exportFormat) {\n  case 'draftjs':\n    return { data: JSON.stringify(blockData, null, 2), ext: 'json' };\n  case 'txt':\n    return { data: draftToTxt(blockData), ext: 'txt' };\n  default:\n    // code block\n    console.error('Did not recognise the export format');\n  }\n};\n\nexport default exportAdapter;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Tooltip from 'react-simple-tooltip';\nimport { Map, List, fromJS } from 'immutable'\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faQuestionCircle, faMousePointer, faICursor, faUserEdit, faKeyboard, faSave, faShareSquare } from '@fortawesome/free-solid-svg-icons';\n\nimport {\n  Editor,\n  EditorState,\n  CompositeDecorator,\n  convertFromRaw,\n  convertToRaw,\n  getDefaultKeyBinding,\n  Modifier,\n  KeyBindingUtil,\n  SelectionState,\n} from 'draft-js';\n\nimport Word from './Word';\nimport WrapperBlock from './WrapperBlock';\n\nimport sttJsonAdapter from '../../Util/adapters/index.js';\nimport exportAdapter from '../../Util/export-adapters/index.js';\nimport style from './index.module.css';\n\nconst { hasCommandModifier } = KeyBindingUtil;\n\nclass TimedTextEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      editorState: EditorState.createEmpty(),\n      transcriptData: this.props.transcriptData,\n      isEditable: this.props.isEditable,\n      sttJsonType: this.props.sttJsonType,\n      timecodeOffset: this.props.timecodeOffset,\n      showSpeakers: this.props.showSpeakers,\n      showTimecodes: this.props.showTimecodes,\n      // inputCount: 0,\n      currentWord: {},\n      settingTimecodeFor: null,\n    };\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  static getDerivedStateFromProps(nextProps) {\n    if (nextProps.transcriptData !== null) {\n\n      return {\n        transcriptData: nextProps.transcriptData,\n        isEditable: nextProps.isEditable,\n        timecodeOffset: nextProps.timecodeOffset,\n        showSpeakers: nextProps.showSpeakers,\n        showTimecodes: nextProps.showTimecodes\n      };\n    }\n\n    return null;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (\n      (prevState.transcriptData !== this.state.transcriptData)\n      && ( this.props.mediaUrl!== null && !this.isPresentInLocalStorage(this.props.mediaUrl) )\n    ) {\n      this.loadData();\n    }\n    if (prevState.timecodeOffset !== this.state.timecodeOffset\n      || prevState.showSpeakers !== this.state.showSpeakers\n      || prevState.showTimecodes !== this.state.showTimecodes) {\n      // forcing a re-render is an expensive operation and\n      // there might be a way of optimising this at a later refactor (?)\n      // the issue is that WrapperBlock is not update on TimedTextEditor\n      // state change otherwise.\n      // for now compromising on this, as setting timecode offset, and\n      // display preferences for speakers and timecodes are not expected to\n      // be very frequent operations but rather one time setup in most cases.\n      this.forceRenderDecorator();\n    }\n  }\n\n  onChange = (editorState) => {\n    // https://draftjs.org/docs/api-reference-editor-state#lastchangetype\n    // https://draftjs.org/docs/api-reference-editor-change-type\n    // doing editorStateChangeType === 'insert-characters'  is triggered even\n    // outside of draftJS eg when clicking play button so using this instead\n    // see issue https://github.com/facebook/draft-js/issues/1060\n    if (this.state.editorState.getCurrentContent() !== editorState.getCurrentContent()) {\n      if (this.props.isPauseWhileTypingOn) {\n        if (this.props.isPlaying()) {\n          this.props.playMedia(false);\n          // Pause video for X seconds\n          /*  NOTE trying it without auto-resume, for better control and maybe less clunky UI\n          const pauseWhileTypingIntervalInMilliseconds = 4*1000;\n          // resets timeout\n          clearTimeout(this.pauseWhileTypingTimeOut);\n          this.pauseWhileTypingTimeOut = setTimeout(function() {\n            // after timeout starts playing again\n            this.props.playMedia(true);\n          }.bind(this), pauseWhileTypingIntervalInMilliseconds);\n          */ \n        }\n      }\n\n      /*\n      // trying to keep length to whole block, including latest additions\n      const contentState = editorState.getCurrentContent();\n      const blockKey = contentState.getSelectionAfter().getStartKey() // TODO maybe should be getSelectionAfter\n      const currentBlock = contentState.getBlockForKey(blockKey)\n      console.log(\"block key\", blockKey, currentBlock)\n      const entityKey = this.findEntityKeyForBlock(currentBlock)\n      console.log(entityKey)\n      contentState.mergeEntityData(entityKey, {\n        offset: 0,\n        length: currentBlock.getText().length\n      })\n      */\n    }\n\n    if (this.state.isEditable) {\n      this.setState(() => ({\n        editorState\n      }), () => {\n        // saving when user has stopped typing for more then five seconds\n        if (this.saveTimer!== undefined) {\n          clearTimeout(this.saveTimer);\n        }\n        this.saveTimer = setTimeout(() => {\n          this.localSave(this.props.mediaUrl);\n        }, 5000);\n      });\n    }\n\n  }\n\n  // helper for getting the entity for the block\n  // apparently there's no better way.. https://github.com/facebook/draft-js/issues/1681\n  /*\n  findEntityKeyForBlock = (block) => {\n    let entity\n    for (var i = 0; i < block.getText().length; i++) {\n      entity = block.getEntityAt(i)\n      if (entity) {\n        break\n      }\n    }\n  \n    return entity\n  } */\n\n  loadData() {\n    if (this.props.transcriptData !== null) {\n      const blocks = sttJsonAdapter(this.props.transcriptData, this.props.sttJsonType);\n      if (blocks.blocks.length === 0) {\n        console.error(\"No Blocks returned!\")\n        alert(\"No Blocks returned!\")\n\n        // TODO this still breaks but allows user to continue doing some stuff at least...\n        // probably want better error handling\n        return \n      }\n      this.setEditorContentState(blocks);\n    }\n  }\n\n  getEditorContent(exportFormat) {\n    const format = exportFormat || 'draftjs';\n\n    return exportAdapter(convertToRaw(this.state.editorState.getCurrentContent()), format);\n  }\n\n  // click on words - for navigation\n  // eslint-disable-next-line class-methods-use-this\n  handleDoubleClick = (event) => {\n    // nativeEvent --> React giving you the DOM event\n    let element = event.nativeEvent.target;\n    // find the parent in Word that contains span with time-code start attribute\n    while (!element.hasAttribute('data-start') && element.parentElement) {\n      element = element.parentElement;\n    }\n\n    if (element.hasAttribute('data-start')) {\n      const t = parseFloat(element.getAttribute('data-start'));\n      this.props.onWordClick(t);\n    }\n  }\n\n  localSave = () => {\n    console.log('localSave');\n    clearTimeout(this.saveTimer);\n    let mediaUrlName = this.props.mediaUrl;\n    // if using local media instead of using random blob name\n    // that makes it impossible to retrieve from on page refresh\n    // use file name\n    if (this.props.mediaUrl.includes('blob')) {\n      mediaUrlName = this.props.fileName;\n    }\n\n    const data = convertToRaw(this.state.editorState.getCurrentContent());\n    localStorage.setItem(`draftJs-${ mediaUrlName }`, JSON.stringify(data));\n    const newLastLocalSavedDate = new Date().toString();\n    localStorage.setItem(`timestamp-${ mediaUrlName }`, newLastLocalSavedDate);\n\n    // return newLastLocalSavedDate;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  isPresentInLocalStorage(mediaUrl) {\n    if (mediaUrl !== null) {\n      let mediaUrlName = mediaUrl;\n\n      if (mediaUrl.includes('blob')) {\n        mediaUrlName = this.props.fileName;\n      }\n\n      const data = localStorage.getItem(`draftJs-${ mediaUrlName }`);\n      if (data !== null) {\n        return true;\n      }\n\n      return false;\n    }\n\n    return false;\n  }\n\n  loadLocalSavedData(mediaUrl) {\n    let mediaUrlName = mediaUrl;\n    if (mediaUrl.includes('blob')) {\n      mediaUrlName = this.props.fileName;\n    }\n    const data = JSON.parse(localStorage.getItem(`draftJs-${ mediaUrlName }`));\n    if (data !== null) {\n      const lastLocalSavedDate = localStorage.getItem(`timestamp-${ mediaUrlName }`);\n      this.setEditorContentState(data);\n\n      return lastLocalSavedDate;\n    }\n\n    return '';\n  }\n\n  // originally from\n  // https://github.com/draft-js-plugins/draft-js-plugins/blob/master/draft-js-counter-plugin/src/WordCounter/index.js#L12\n  getWordCount = (editorState) => {\n    const plainText = editorState.getCurrentContent().getPlainText('');\n    const regex = /(?:\\r\\n|\\r|\\n)/g; // new line, carriage return, line feed\n    const cleanString = plainText.replace(regex, ' ').trim(); // replace above characters w/ space\n    const wordArray = cleanString.match(/\\S+/g); // matches words according to whitespace\n\n    return wordArray ? wordArray.length : 0;\n  }\n\n  /**\n  * @param {object} data.entityMap - draftJs entity maps - used by convertFromRaw\n  * @param {object} data.blocks - draftJs blocks - used by convertFromRaw\n  * set DraftJS Editor content state from blocks\n  * contains blocks and entityMap\n  */\n  setEditorContentState = (data) => {\n    if (!data || !data.blocks.length) {\n      console.error(\"No data given!\")\n    }\n    const contentState = convertFromRaw(data);\n    // eslint-disable-next-line no-use-before-define\n    const editorState = EditorState.createWithContent(contentState); // , decorator);\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TimedTextEditor',\n        action: 'setEditorContentState',\n        name: 'getWordCount',\n        value: this.getWordCount(editorState)\n      });\n    }\n\n    this.setState({ editorState });\n  }\n\n  // Helper function to re-render this component\n  // used to re-render WrapperBlock on timecode offset change\n  // or when show / hide preferences for speaker labels and timecodes change\n  // RQ: trying without decorator for speed \n  forceRenderDecorator = () => {\n    // const { editorState, updateEditorState } = this.props;\n    const contentState = this.state.editorState.getCurrentContent();\n    // const decorator = this.state.editorState.getDecorator();\n\n    const newState = EditorState.createWithContent(\n      contentState,\n      // decorator\n    );\n\n    // this.setEditorNewContentState(newState);\n    const newEditorState = EditorState.push(newState, contentState);\n    this.setState({ editorState: newEditorState });\n  }\n\n  /**\n  * Update Editor content state\n  */\n  setEditorNewContentState = (newContentState) => {\n    const newEditorState = EditorState.push(this.state.editorState, newContentState);\n    this.setState({ editorState: newEditorState });\n\n    return newEditorState\n  }\n\n  /**\n   * Listen for draftJs custom key bindings\n   */\n  customKeyBindingFn = (e) => {\n    const enterKey = 13;\n    const spaceKey =32;\n    const kKey = 75;\n    const lKey = 76;\n    const jKey = 74;\n    const equalKey = 187;//used for +\n    const minusKey = 189; // -\n    const rKey = 82;\n    const tKey = 84;\n\n    if (e.keyCode === enterKey ) {\n      return 'split-paragraph';\n    }\n    // if alt key is pressed in combination with these other keys\n    if (e.altKey && ((e.keyCode === spaceKey)\n    || (e.keyCode === spaceKey)\n    || (e.keyCode === kKey)\n    || (e.keyCode === lKey)\n    || (e.keyCode === jKey)\n    || (e.keyCode === equalKey)\n    || (e.keyCode === minusKey)\n    || (e.keyCode === rKey)\n    || (e.keyCode === tKey))\n    ) {\n      e.preventDefault();\n\n      return 'keyboard-shortcuts';\n    }\n\n    return getDefaultKeyBinding(e);\n  }\n\n  /**\n   * Handle draftJs custom key commands\n   */\n  handleKeyCommand = (command) => {\n    if (command === 'split-paragraph') {\n      this.splitParagraph();\n    }\n\n    if (command === 'keyboard-shortcuts') {\n      return 'handled';\n    }\n\n    return 'not-handled';\n  }\n\n  /**\n   * Helper function to handle splitting paragraphs with return key\n   * on enter key, perform split paragraph at selection point.\n   * Add timecode of next word after split to paragraph\n   * as well as speaker name to new paragraph\n   */\n  splitParagraph = () => {\n    // https://github.com/facebook/draft-js/issues/723#issuecomment-367918580\n    // https://draftjs.org/docs/api-reference-selection-state#start-end-vs-anchor-focus\n    const currentSelection = this.state.editorState.getSelection();\n    // only perform if selection is not selecting a range of words\n    // in that case, we'd expect delete + enter to achieve same result.\n    if (currentSelection.isCollapsed()) {\n      const currentContent = this.state.editorState.getCurrentContent();\n      // https://draftjs.org/docs/api-reference-modifier#splitblock\n      const newContentState = Modifier.splitBlock(currentContent, currentSelection);\n      // https://draftjs.org/docs/api-reference-editor-state#push\n      // splitState is new editor state after the push\n      const splitState = EditorState.push(this.state.editorState, newContentState, 'split-block');\n      const targetSelection = splitState.getSelection();\n\n      const originalBlock = currentContent.blockMap.get(newContentState.selectionBefore.getStartKey());\n      const originalBlockData = originalBlock.getData();\n      const blockSpeaker = originalBlockData.get('speaker');\n      const blockStartTime = originalBlockData.get('start');\n\n      const wordStartTime = blockStartTime;\n\n      // split paragraph\n      // https://draftjs.org/docs/api-reference-modifier#mergeblockdata\n\n      // adding words data too\n      // starts with same worddata, and then replace the 'word' and 'punct' keys\n      let wordsDataForNew = originalBlockData.get('words') || [ {} ];\n      // if (!List.isList(wordsDataForNew) || !Map.isMap(wordsDataForNew)) {\n      if (!Map.isMap(wordsDataForNew)) {\n        wordsDataForNew = fromJS(wordsDataForNew);\n      }\n      const newBlock = newContentState.getBlockAfter(originalBlock.getKey());\n      // make word and punct just the new words and punct\n      // TODO thinking of maybe keeping the original punct and word keys alone, even when splitting, since we never use it. Though it does make things confusing, shows where things originated from, and we never use that data (I think...) in the actual app\n      wordsDataForNew = wordsDataForNew.setIn([ 0, 'word' ], newBlock.getText())\n        .setIn([ 0, 'punct' ], newBlock.getText());\n\n      const afterMergeContentState = Modifier.mergeBlockData(\n        splitState.getCurrentContent(),\n        targetSelection,\n        {\n          'start': wordStartTime,\n          'speaker': blockSpeaker,\n          'words': wordsDataForNew,\n        }\n      );\n      const newestEditorState = this.setEditorNewContentState(afterMergeContentState);\n\n      // update old transcript word and punct\n      let wordsDataForOld = originalBlockData.get('words') || [ {} ];\n      // if (!List.isList(wordsDataForOld) || !Map.isMap(wordsDataForOld)) {\n      if (!Map.isMap(wordsDataForOld)) {\n        wordsDataForOld = fromJS(wordsDataForOld);\n      }\n      const wordsLeft = originalBlock.getText().slice(0, - (newBlock.getText().length));\n      // TODO thinking of maybe keeping the original punct and word keys alone, even when splitting, since we never use it. Though it does make things confusing, shows where things originated from, and we never use that data (I think...) in the actual app\n      wordsDataForOld = wordsDataForOld.setIn([ 0, 'word' ], wordsLeft)\n        .setIn([ 0, 'punct' ], wordsLeft);\n\n      const afterMergeContentState2 = Modifier.mergeBlockData(\n        newestEditorState.getCurrentContent(),\n        SelectionState.createEmpty(originalBlock.getKey()),\n        {\n          'words': wordsDataForOld,\n        }\n      );\n      this.setEditorNewContentState(afterMergeContentState2);\n\n\n      return 'handled';\n    }\n\n    return 'not-handled';\n  }\n\n  /**\n   * Helper function for splitParagraph\n   * to find the closest entity (word) to a selection point\n   * that does not fall on an entity to begin with\n   * Looks before if it's last char in a paragraph block.\n   * After for everything else.\n   */\n    /*\n  findClosestEntityKeyToSelectionPoint = (currentSelection, originalBlock) => {\n    // set defaults\n    let entityKey = null;\n    let isEndOfParagraph = false;\n\n    // selection offset from beginning of the paragraph block\n    const startSelectionOffsetKey = currentSelection.getStartOffset();\n    // length of the plain text for the ContentBlock\n    const lengthPlainTextForTheBlock = originalBlock.getLength();\n    // number of char from selection point to end of paragraph\n    const remainingCharNumber = lengthPlainTextForTheBlock - startSelectionOffsetKey;\n    // if it's the last char in the paragraph - get previous entity\n    if (remainingCharNumber === 0 ) {\n      isEndOfParagraph = true;\n      for (let j = lengthPlainTextForTheBlock; j >0 ; j--) {\n        entityKey = originalBlock.getEntityAt(j);\n        if (entityKey!== null) {\n          // if it finds it then return\n          return { entityKey, isEndOfParagraph };\n        }\n      }\n    }\n    // if it's first char or another within the block - get next entity\n    else {\n      console.log('Main part of paragraph');\n      let initialSelectionOffset = currentSelection.getStartOffset();\n      for (let i = 0; i < remainingCharNumber ; i++) {\n        initialSelectionOffset +=i;\n        entityKey = originalBlock.getEntityAt(initialSelectionOffset);\n        // if it finds it then return\n        if (entityKey !== null) {\n          return { entityKey, isEndOfParagraph };\n        }\n      }\n    }\n\n    // cover edge cases where it doesn't find it\n    return { entityKey, isEndOfParagraph };\n  }*/\n\n  updateTimecode = (data) => {\n    console.log(\"updating with data\", data)\n  }\n\n  renderBlockWithTimecodes = () => {\n    return {\n      component: WrapperBlock,\n      editable: true,\n      props: {\n        showSpeakers: this.state.showSpeakers,\n        showTimecodes: this.state.showTimecodes,\n        timecodeOffset: this.state.timecodeOffset,\n        editorState: this.state.editorState,\n        setEditorNewContentState: this.setEditorNewContentState,\n        onJumpToHereClick: this.props.onJumpToHereClick,\n        onWordClick: this.props.onWordClick,\n        handleAnalyticsEvents: this.props.handleAnalyticsEvents,\n        settingTimecodeFor: this.state.settingTimecodeFor,\n        updateTimecode: this.updateTimecode,\n        togglePlayMedia: this.props.playMedia,\n        isPlaying: this.props.isPlaying,\n        currentTime: this.props.currentTime,\n      }\n    };\n  }\n\n  copyCurrentTimeToClipboard = () => {\n    const text = `https://ryanquey.github.io/khmer-react-transcript-editor?startTime=${ this.props.currentTime }`\n    navigator.clipboard.writeText(text).then(function() {\n      console.log('Async: Copying to clipboard was successful!');\n    }, function(err) {\n      console.error('Async: Could not copy text: ', err);\n    });\n  }\n\n  // TODO just do 2 js calls, one to scroll, the other to get current word. Much neater\n  getCurrentWord = (checkToScroll = true) => {\n    const currentWord = {\n      start: 'NA',\n      end: 'NA'\n    };\n\n    const nextWord = {\n      start: 'NA',\n      end: 'NA'\n    };\n\n    let blockMap\n    if (this.state.transcriptData) {\n      const contentState = this.state.editorState.getCurrentContent();\n      // TODO: using convertToRaw here might be slowing down performance(?)\n      const contentStateConvertEdToRaw = convertToRaw(contentState);\n      blockMap = contentStateConvertEdToRaw.blocks;\n\n      // TODO since ran so many times, consider slightly faster loop (reg for loop?)\n      for (var i = 0; i < blockMap.length; i++) {\n        const block = blockMap[i] || {};\n        let word = ((block.data || {}).words || [])\n        \n        // TODO happens if we split a paragraph...need a better more consistent system for this...\n        if (List.isList(word)) {\n          word = word.toJSON()[0] || {};\n        } else {\n          word = word[0] || {}\n        }\n        if (word.end === undefined || word.end === undefined) {\n          console.log(\"this word is broken...\", word, block)\n        }\n\n        if (word.start <= this.props.currentTime && word.end >= this.props.currentTime) {\n          currentWord.start = word.start;\n          currentWord.end = word.end;\n\n          const nextBlock = blockMap[i + 2] || blockMap[i + 1]\n          const next = ((nextBlock.data || {}).words || [])[0] || {};\n          if (next) {\n            // won't be a next for last word in transcript\n            nextWord.start = next.start;\n            nextWord.end = next.end;\n          }\n          break\n        }\n\n      }\n    }\n\n    if (checkToScroll && currentWord.start !== 'NA') {\n      if (this.props.isScrollIntoViewOn) {\n        const thisWordElement = document.querySelector(`.Word[data-start=\"${ currentWord.start }\"]`);\n        const nextWordElement = document.querySelector(`.Word[data-start=\"${ nextWord.start }\"]`);\n        // there should always be currentWordElement, but just in case...\n        thisWordElement && thisWordElement.scrollIntoView({ block: 'nearest', inline: 'center' });\n        nextWordElement && nextWordElement.scrollIntoView({ block: 'nearest', inline: 'center' });\n      }\n    }\n    if (this.state.transcriptData && currentWord.start === \"NA\") {\n      // there's a bug in the code!\n      // console.log(\"What is going wrong with the blocks?\", blockMap, \"currentWord\", currentWord);\n      // console.log(\"for the time:\", this.props.currentTime);\n    }\n\n    return currentWord;\n  }\n\n  render() {\n    const helpMessage = <div className={ style.helpMessage }>\n      <span><FontAwesomeIcon className={ style.icon } icon={ faMousePointer } />Double click on a word or timestamp to jump to that point in the video.</span>\n      <span><FontAwesomeIcon className={ style.icon } icon={ faICursor } />Start typing to edit text.</span>\n      <span><FontAwesomeIcon className={ style.icon } icon={ faUserEdit } />You can add and change names of speakers in your transcript.</span>\n      <span><FontAwesomeIcon className={ style.icon } icon={ faKeyboard } />Use keyboard shortcuts for quick control.</span>\n      <span><FontAwesomeIcon className={ style.icon } icon={ faSave } />Save & export to get a copy to your desktop.</span>\n    </div>;\n\n    const tooltip = <Tooltip\n      className={ style.help }\n      content={ helpMessage }\n      fadeDuration={ 250 }\n      fadeEasing={ 'ease-in' }\n      placement={ 'bottom' }\n      radius={ 5 }>\n      <FontAwesomeIcon className={ style.icon } icon={ faQuestionCircle } />\n      How does this work?\n    </Tooltip>;\n\n    const currentWord = this.getCurrentWord(true); // true, so scrolls if setting says to\n    const highlightColour = '#c0def3';\n    const unplayedColor = '#767676';\n    const correctionBorder = '1px dotted blue';\n\n    // Time to the nearest half second\n    const time = Math.round(this.props.currentTime * 4.0) / 4.0;\n\n    const editor = (\n      <section\n        className={ style.editor }\n        onDoubleClick={ event => this.handleDoubleClick(event) }>\n\n        <style scoped>\n          {`.Word[data-start=\"${ currentWord.start }\"] { background-color: ${ highlightColour }; text-shadow: 0 0 0.01px black }`}\n          {/*`div.Word[data-start=\"${ currentWord.start }\"]+span { background-color: ${ highlightColour } }` This would highlight edits that are added to the original. Doesn't highlight text before though...would have to use JS and dig into draft js more   */}\n          {`.Word[data-prev-times~=\"${ Math.floor(time) }\"] { color: ${ unplayedColor } }`}\n          {`.Word[data-prev-times~=\"${ time }\"] { color: ${ unplayedColor } }`}\n          {`.Word[data-confidence=\"low\"] { border-bottom: ${ correctionBorder } }`}\n        </style>\n\n        <Editor\n          editorState={ this.state.editorState }\n          onChange={ this.onChange }\n          stripPastedStyles\n          blockRendererFn={ this.renderBlockWithTimecodes }\n          handleKeyCommand={ command => this.handleKeyCommand(command) }\n          keyBindingFn={ e => this.customKeyBindingFn(e) }\n        />\n      </section>\n    );\n\n    return (\n      <section>\n        { tooltip }\n        <FontAwesomeIcon icon={ faShareSquare } onClick = { this.copyCurrentTimeToClipboard } style={ { cursor: 'pointer' } }/>\n        { this.props.transcriptData !== null ? editor : null }\n      </section>\n    );\n  }\n}\n\n// DraftJs decorator to recognize which entity is which\n// and know what to apply to what component\n  /*\nconst getEntityStrategy = mutability => (contentBlock, callback, contentState) => {\n  contentBlock.findEntityRanges((character) => {\n    const entityKey = character.getEntity();\n    if (entityKey === null) {\n      return false;\n    }\n\n    return contentState.getEntity(entityKey).getMutability() === mutability;\n  }, callback);\n};\n\n// decorator definition - Draftjs\n// defines what to use to render the entity\nconst decorator = new CompositeDecorator([\n  {\n    strategy: getEntityStrategy('MUTABLE'),\n    component: Word,\n  },\n]);\n*/ // NOTE no longer using entities, so not really using the Word component in same way either, just using the WrapperBlock\n\nTimedTextEditor.propTypes = {\n  transcriptData: PropTypes.object,\n  mediaUrl: PropTypes.string,\n  isEditable: PropTypes.bool,\n  onWordClick: PropTypes.func,\n  sttJsonType: PropTypes.string,\n  isPlaying: PropTypes.func,\n  playMedia: PropTypes.func,\n  currentTime: PropTypes.number,\n  isScrollIntoViewOn: PropTypes.bool,\n  isPauseWhileTypingOn: PropTypes.bool,\n  timecodeOffset: PropTypes.number,\n  handleAnalyticsEvents: PropTypes.func\n};\n\nexport default TimedTextEditor;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass VideoPlayer extends React.Component {\n  render() {\n    return (\n      <video\n        id=\"video\"\n        playsInline\n        src={ this.props.mediaUrl }\n        onTimeUpdate={ this.props.onTimeUpdate }\n        type=\"video/mp4\"\n        data-testid=\"media-player-id\"\n        onClick={ this.props.onClick }\n        onLoadedData={ this.props.onLoadedDataGetDuration }\n        ref={ this.props.videoRef }\n      />\n    );\n  }\n}\n\nVideoPlayer.propTypes = {\n  mediaUrl: PropTypes.string,\n  onTimeUpdate: PropTypes.func,\n  onClick: PropTypes.func,\n  videoRef: PropTypes.object,\n  onLoadedDataGetDuration: PropTypes.func\n};\n\nexport default VideoPlayer;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport styles from './VolumeControl.module.css';\nclass VolumeControl extends React.Component {\n\n  render() {\n    return (\n      <div className={ styles.switchContainer }>\n        <label className={ styles.switch }>\n          <input type=\"checkbox\"\n            defaultChecked=\"true\"\n            onChange={ this.props.handleMuteVolume }\n          />\n          <span className={ styles.slider }></span>\n        </label>\n        <label className={ styles.label }>Volume</label>\n      </div>\n    );\n  }\n}\n\nVolumeControl.propTypes = {\n  handleMuteVolume: PropTypes.func\n};\n\nexport default VolumeControl;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport style from './Select.module.css';\n\nclass Select extends React.Component {\n\n  render() {\n    const options = this.props.options.map((option, index) => {\n      // eslint-disable-next-line react/no-array-index-key\n      return <option key={ index } value={ option.value }>{option.label}</option>;\n    });\n\n    return (\n      <select className={ style.selectPlayerControl } name={ this.props.name } value={ this.props.currentValue } onChange={ this.props.handleChange }>\n        {options}\n      </select>\n    );\n  }\n}\n\nSelect.propTypes = {\n  options: PropTypes.array,\n  name: PropTypes.string,\n  currentValue: PropTypes.string,\n  handleChange: PropTypes.func\n};\n\nexport default Select;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport VolumeControl from './VolumeControl';\nimport Select from './Select';\n\nimport style from './PlayerControls.module.css';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport {\n  faSave,\n  faTv,\n  faPlay,\n  faPause,\n  faBackward,\n  faForward,\n  faUndo\n} from '@fortawesome/free-solid-svg-icons';\n\nclass PlayerControls extends React.Component {\n  // to handle backward and forward mouse pressed on btn\n  // set a 300 ms  interval to repeat the\n  // backward or forward function\n  // on mouseUp the interval is cleared\n  setIntervalHelperBackward = () => {\n    this.props.skipBackward();\n    if (this.interval) {\n      this.clearIntervalHelper()\n    }\n    this.interval = setInterval(() => {\n      this.props.skipBackward();\n    }, 300);\n  }\n\n  setIntervalHelperForward = () => {\n    this.props.skipForward();\n    if (this.interval) {\n      this.clearIntervalHelper()\n    }\n    this.interval = setInterval(() => {\n      this.props.skipForward();\n    }, 300);\n  }\n\n  clearIntervalHelper = () => {\n    clearInterval(this.interval);\n  }\n\n  render() {\n    return (\n      <div className={ style.playerControls }>\n        <button\n          title=\"Rollback\"\n          className={ style.playerButton }\n          onClick={ this.props.rollback }>\n          <FontAwesomeIcon icon={ faUndo } />\n        </button>\n\n        <button\n          title=\"Rewind\"\n          className={ style.playerButton }\n          onMouseDown={ this.setIntervalHelperBackward }\n          onMouseUp={ this.clearIntervalHelper }>\n          <FontAwesomeIcon icon={ faBackward } />\n\n        </button>\n\n        <button\n          title=\"Play\"\n          className={ style.playerButton }\n          onClick={ this.props.playMedia }>\n          {this.props.isPlaying ? <FontAwesomeIcon icon={ faPause } /> : <FontAwesomeIcon icon={ faPlay } />}\n        </button>\n\n        <button\n          title=\"Forward\"\n          className={ style.playerButton }\n          onMouseDown={ this.setIntervalHelperForward }\n          onMouseUp={ this.clearIntervalHelper }>\n          <FontAwesomeIcon icon={ faForward } />\n        </button>\n\n        <span className={ style.playBackRate }>\n          <Select\n            title=\"Playback rate\"\n            options={ this.props.playbackRateOptions }\n            currentValue={ this.props.playbackRate.toString() }\n            name={ 'playbackRate' }\n            handleChange={ this.props.setPlayBackRate } />\n        </span>\n\n        <div className={ style.timeBox }>\n          <span title=\"Current time\" className={ style.currentTime }\n            onClick={ this.props.promptSetCurrentTime }\n          >{ this.props.currentTime }</span>\n          <span className={ style.separator }>|</span>\n          <span title=\"Clip duration\" className={ style.duration }>{this.props.duration}</span>\n        </div>\n\n        <button\n          title=\"Save\"\n          className={ style.playerButton }\n          onClick={ this.props.handleSaveTranscript }>\n          <FontAwesomeIcon icon={ faSave } />\n        </button>\n\n        <button\n          title=\"Picture-in-picture\"\n          className={ style.playerButton }\n          onClick={ this.props.pictureInPicture }\n        >\n          <FontAwesomeIcon icon={ faTv } />\n        </button>\n\n        <VolumeControl\n          handleMuteVolume={ this.props.handleMuteVolume }\n        />\n      </div>\n    );\n  }\n}\n\nPlayerControls.propTypes = {\n  playMedia: PropTypes.func,\n  currentTime: PropTypes.string,\n  timecodeOffset: PropTypes.string,\n  promptSetCurrentTime: PropTypes.func,\n  rollback: PropTypes.func,\n  handleMuteVolume: PropTypes.func,\n  duration: PropTypes.string,\n  isPlaying: PropTypes.bool,\n  skipBackward: PropTypes.func,\n  skipForward: PropTypes.func,\n  playbackRate: PropTypes.number,\n  playbackRateOptions: PropTypes.array,\n  setPlayBackRate: PropTypes.func,\n  pictureInPicture: PropTypes.func\n};\n\nexport default PlayerControls;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport style from './ProgressBar.module.css';\n\nclass ProgressBar extends React.Component {\n\n  render() {\n    return (\n      <div className={ style.progress }>\n        <input\n          type='range'\n          className={ style.bar }\n          onChange={ this.props.buttonClick }\n          value={ this.props.value }\n          min='0'\n          max={ this.props.max.toString() }\n        />\n      </div>\n    );\n  }\n}\n\nProgressBar.propTypes = {\n  value: PropTypes.number,\n  max: PropTypes.string,\n  buttonClick: PropTypes.func\n};\n\nexport default ProgressBar;\n","function returnHotKeys(self) {\n  return {\n    'alt+k': {\n      priority: 1,\n      handler: () => {\n        self.togglePlayMedia();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+k',\n          name: 'togglePlayMedia',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + k',\n      label: 'Play Media',\n    },\n    'alt+l': {\n      priority: 1,\n      handler: () => {\n        self.skipForward();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+l',\n          name: 'skipForward',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + l',\n      label: 'Fast Forward',\n    },\n    /*'alt+j': {\n      priority: 1,\n      handler: () => {\n        self.skipBackward();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+j',\n          name: 'skipBackward',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + j',\n      label: 'Rewind',\n    },*/\n    'alt+-': {\n      priority: 1,\n      handler: () => {\n        self.decreasePlaybackRate();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+-',\n          name: 'decreasePlaybackRate',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + -',\n      label: 'Decrease Playback Speed',\n    },\n    // https://github.com/ccampbell/mousetrap/issues/266\n    'alt+=': {\n      priority: 1,\n      handler: () => {\n        self.increasePlaybackRate();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+plus',\n          name: 'increasePlaybackRate',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + +',\n      label: 'Increase Playback Speed',\n    },\n    'alt+u': {\n      priority: 1,\n      handler: () => {\n        self.jumpToStartOfBlock();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+u',\n          name: 'jumpToStartOfBlock',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + u',\n      label: 'Jump to Start of Current Section',\n    },\n    /*\n    'alt+h': {\n      priority: 1,\n      handler: () => {\n        self.editCurrentBlockTime();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+h',\n          name: 'editCurrentBlockTime',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + h',\n      label: 'Edit Current Section Time',\n    },*/\n    'alt+j': {\n      priority: 1,\n      handler: () => {\n        self.rollBack();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+j',\n          name: 'rollBack',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + j',\n      label: 'Roll Back',\n    },\n    'alt+t': {\n      priority: 1,\n      handler: () => {\n        self.promptSetCurrentTime();\n\n        self.props.handleAnalyticsEvents({\n          category: 'defaultHotKeys',\n          action: 'alt+t',\n          name: 'promptSetCurrentTime',\n          value: 'na'\n        });\n\n      },\n      displayKeyCombination: 'alt + t',\n      label: 'set current time',\n    }\n  };\n}\nexport default returnHotKeys;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { hotkeys } from 'react-keyboard-shortcuts';\n\nimport VideoPlayer from './VideoPlayer';\nimport PlayerControls from './PlayerControls';\nimport ProgressBar from './ProgressBar';\n\nimport returnHotKeys from './defaultHotKeys';\nimport styles from './index.module.css';\n\nimport { secondsToTimecode, timecodeToSeconds } from '../../Util/timecode-converter/index';\nimport { timingSafeEqual } from 'crypto';\nimport { convertToArabicNumbers } from '../../Util/khmer-numbers/';\n\nconst PLAYBACK_RATES = [\n  //  { value: 0.2, label: '0.2' },\n  { value: 0.25, label: '0.25' },\n  { value: 0.5, label: '0.5' },\n  { value: 0.75, label: '0.75' },\n  { value: 1, label: '1' },\n  { value: 1.25, label: '1.25' },\n  { value: 1.5, label: '1.5' },\n  { value: 1.75, label: '1.75' },\n  // { value: 2, label: '2' },\n  // { value: 2.5, label: '2.5' },\n  // { value: 3, label: '3' },\n  // { value: 3.5, label: '3.5' }\n];\n\nclass MediaPlayer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.videoRef = React.createRef();\n\n    this.state = {\n      playbackRate: 1,\n      rollBackValueInSeconds: this.props.rollBackValueInSeconds,\n      timecodeOffset: this.props.timecodeOffset,\n      hotKeys: returnHotKeys(this),\n      isPlaying: false,\n      playbackRateOptions: PLAYBACK_RATES,\n      mediaDuration: '00:00:00:00',\n    };\n  }\n  /*eslint-disable camelcase */\n  hot_keys = returnHotKeys(this);\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (nextProps.timecodeOffset !== null) {\n      let newCurrentTimeInSeconds = nextProps.timecodeOffset ;\n      if (typeof newCurrentTimeInSeconds ==='string'\n        && newCurrentTimeInSeconds.includes(':')\n        && !newCurrentTimeInSeconds.includes('NaN')) {\n        newCurrentTimeInSeconds = timecodeToSeconds(nextProps.timecodeOffset );\n      }\n\n      return {\n        timecodeOffset: newCurrentTimeInSeconds,\n        rollBackValueInSeconds: nextProps.rollBackValueInSeconds,\n      };\n    }\n\n    return null;\n  }\n\n  componentDidMount() {\n    this.props.hookSeek(this.setCurrentTime);\n    this.props.hookPlayMedia(this.togglePlayMedia);\n    this.props.hookIsPlaying(this.isPlaying);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.playingWhileListening && !prevProps.playingWhileListening && !this.state.isPlaying) {\n      this.playMedia()\n    }\n  }\n\n  setCurrentTime = (newCurrentTime) => {\n    if (newCurrentTime !== '' && newCurrentTime !== null) {\n    // hh:mm:ss:ff - mm:ss - m:ss - ss - seconds number or string and hh:mm:ss\n      const newCurrentTimeInSeconds = timecodeToSeconds(newCurrentTime);\n      if (this.videoRef.current !== null && !isNaN(newCurrentTimeInSeconds)) {\n        const videoRef = this.videoRef.current;\n\n        if (videoRef.readyState === 4) {\n          videoRef.currentTime = newCurrentTimeInSeconds;\n          this.playMedia();\n        }\n      } else {\n        console.log(\"failed to jump to time:\", newCurrentTimeInSeconds, newCurrentTime)\n      }\n    }\n  }\n\n  /**\n   * Prompts for a time stamp or time code to set media current time\n   * Also handles use can when the user has set a timecode offset via settings\n   * and the prompt is expected to be relative to that offset\n   */\n  promptSetCurrentTime = () => {\n    let userTimecodeValue = prompt('Jump to time - hh:mm:ss:ff hh:mm:ss mm:ss m:ss m.ss seconds');\n    // TODO: add some validation, eg if user types just a string it won't crash.\n    // needs function to check it's either timecode on the formats specified above or a number\n    // this could be part of the timecode module(?)\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'promptSetCurrentTime',\n        name: 'userTimecodeValue',\n        value: userTimecodeValue\n      });\n    }\n    // user clicks cancel to prompt, prompt returns null\n    if (userTimecodeValue !== null) {\n      userTimecodeValue = convertToArabicNumbers(userTimecodeValue)\n\n      if (userTimecodeValue.includes(':')) {\n        userTimecodeValue = timecodeToSeconds(userTimecodeValue);\n      }\n      // remove timecode offset if preset\n      if (this.state.timecodeOffset !== 0) {\n        userTimecodeValue -= this.state.timecodeOffset;\n      }\n\n      this.setCurrentTime(userTimecodeValue);\n    }\n  }\n\n  setTimeCodeOffset = (newTimeCodeOffSet) => {\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'setTimeCodeOffset',\n        name: 'timecodeOffsetValue',\n        value: newTimeCodeOffSet\n      });\n    }\n\n    if (newTimeCodeOffSet !== '' && newTimeCodeOffSet !== null) {\n      // use similar helper function from above to convert\n      let newCurrentTimeInSeconds = newTimeCodeOffSet;\n      if (newTimeCodeOffSet.includes(':')) {\n        newCurrentTimeInSeconds = timecodeToSeconds(newTimeCodeOffSet);\n        this.setState({ timecodeOffset: newCurrentTimeInSeconds });\n      }\n    }\n  }\n\n  rollBack = () => {\n    if (this.videoRef.current !== null) {\n\n      if (this.props.handleAnalyticsEvents !== undefined) {\n        this.props.handleAnalyticsEvents({\n          category: 'MediaPlayer',\n          action: 'rollBack',\n          name: 'rollBackValue',\n          value: this.state.rollBackValueInSeconds\n        });\n      }\n      // get video duration\n      const videoElem = this.videoRef.current;\n      const tmpDesiredCurrentTime = videoElem.currentTime - this.state.rollBackValueInSeconds;\n      // > 0 < duration of video\n      this.setCurrentTime(tmpDesiredCurrentTime);\n\n    }\n  }\n\n  jumpToStartOfBlock = () => {\n    // NOTE this is so bad...so messy. Oh well\n    const currentWord = this.props.timedTextEditorRef.getCurrentWord()\n    if (this.videoRef.current !== null) {\n\n      if (this.props.handleAnalyticsEvents !== undefined) {\n        this.props.handleAnalyticsEvents({\n          category: 'MediaPlayer',\n          action: 'jumpToStartOfBlock',\n          name: 'jumpToStartOfBlock',\n          value: currentWord.start\n        });\n      }\n      // some blocks don't have start time set due to data getting messed up, so just rollback\n      currentWord.start ? this.setCurrentTime(currentWord.start) : this.rollback()\n\n    }\n  }\n\n    /*  TODO use refs on all blocks to access the WrapperBlock react child, and then call the edit block time func\n  editCurrentBlockTime = () => {\n    // NOTE this is so bad...so messy. Oh well\n    console.log(this.props.timedTextEditorRef)\n    const currentWord = this.props.timedTextEditorRef.getCurrentWord()\n    if (this.videoRef.current !== null) {\n\n      if (this.props.handleAnalyticsEvents !== undefined) {\n        this.props.handleAnalyticsEvents({\n          category: 'MediaPlayer',\n          action: 'editCurrentBlockTime',\n          name: 'editCurrentBlockTime',\n          value: currentWord.start\n        });\n      }\n      // some blocks don't have start time set due to data getting messed up, so just rollback\n      currentWord.start ? this.setCurrentTime(currentWord.start) : this.rollback()\n\n    }\n  }\n  */\n\n  handleTimeUpdate = (e) => {\n    this.props.hookOnTimeUpdate(e.target.currentTime);\n  }\n\n  handlePlayBackRateChange = (e) => {\n    this.setPlayBackRate(parseFloat(e.target.value));\n  }\n\n  /**\n   * @param {float} input - playback rate value as a float\n   */\n  setPlayBackRate = (input) => {\n    if (this.videoRef.current !== null) {\n      if (input >= 0.2 && input <= 3.5) {\n        this.setState({\n          playbackRate: input,\n        }, () => {\n          this.videoRef.current.playbackRate = input;\n\n          if (this.props.handleAnalyticsEvents !== undefined) {\n            this.props.handleAnalyticsEvents({\n              category: 'MediaPlayer',\n              action: 'setPlayBackRate',\n              name: 'playbackRateNewValue',\n              value: input\n            });\n          }\n\n        });\n      }\n    }\n  }\n\n  decreasePlaybackRate = () => {\n    const speeds = [ ...PLAYBACK_RATES ].reverse();\n    const slower = speeds.find((option) => {\n      return option.value < this.state.playbackRate;\n    });\n    const newSpeed = slower ? slower.value : 0.2;\n\n    this.setPlayBackRate(newSpeed);\n  }\n\n  increasePlaybackRate = () => {\n    const speeds = [ ...PLAYBACK_RATES ];\n    const faster = speeds.find((option) => {\n      return option.value > this.state.playbackRate;\n    });\n    const newSpeed = faster ? faster.value : 3.5;\n\n    this.setPlayBackRate(newSpeed);\n  }\n\n  handleChangeReplayRollbackValue = (e) => {\n    if (this.videoRef.current !== null) {\n      this.setState({\n        rollBackValueInSeconds: e.target.value,\n      });\n    }\n  }\n\n  handleMuteVolume = () => {\n    if (this.videoRef.current !== null) {\n      if (this.videoRef.current.volume > 0) {\n        this.videoRef.current.volume = 0;\n      } else {\n        this.videoRef.current.volume = 1;\n      }\n    }\n  }\n\n  // TEMP: keeping this in for now. Might be replaced by state\n  // The pauseWhileTyping logic (in TimedTextEditor) currently uses this\n  isPlaying = () => {\n    if (this.videoRef.current !== null) {\n      if (this.videoRef.current.paused) return false;\n\n      return true;\n    }\n  }\n\n  pauseMedia = () => {\n    this.setState({ isPlaying: false }, () => this.videoRef.current.pause());\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'pauseMedia',\n        name: 'pauseMedia',\n        value: secondsToTimecode(this.videoRef.current.currentTime)\n      });\n    }\n  }\n\n  playMedia = () => {\n    this.setState({ isPlaying: true }, () => this.videoRef.current.play());\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'playMedia',\n        name: 'playMedia',\n        value: secondsToTimecode(this.videoRef.current.currentTime)\n      });\n    }\n\n  }\n\n  // Sets isPlaying state and toggles modes on the video player\n  // TODO: modularise these / enable specific play / pause action\n  togglePlayMedia = (e, bool) => {\n    // if no bool specified, then really just toggle\n    if (bool === undefined) {\n      bool = !this.state.isPlaying\n    }\n    if (this.videoRef.current !== null) {\n      if (this.state.isPlaying && !bool) {\n        this.pauseMedia();\n      }\n      else if (!this.state.isPlaying && bool) {\n        this.playMedia();\n      }\n      // in other situations, do nothing\n    }\n  }\n\n  skipForward = () => {\n    if (this.videoRef.current !== null) {\n      // TODO track this?\n      const currentTime = this.videoRef.current.currentTime;\n      const newCurrentTimeIncreased = currentTime + 10;\n      const newCurrentTime = Number((newCurrentTimeIncreased).toFixed(1));\n      this.setCurrentTime(newCurrentTime);\n    }\n  }\n\n  skipBackward = () => {\n    // TODO track this?\n    if (this.videoRef.current !== null) {\n      const currentTime = this.videoRef.current.currentTime;\n      const newCurrentTimeIncreased = currentTime - 10;\n      const newCurrentTime = Number((newCurrentTimeIncreased).toFixed(1));\n      this.setCurrentTime(newCurrentTime);\n    }\n  }\n\n  handleProgressBarClick = (e) => {\n    const time = e.target.value;\n    this.setCurrentTime(time);\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'handleProgressBarClick',\n        name: 'roundNewCurrentTime',\n        value: time\n      });\n    }\n  }\n\n  getMediaCurrentTime = () => {\n    if (this.videoRef.current !== null) {\n      return secondsToTimecode(this.videoRef.current.currentTime + this.state.timecodeOffset);\n    }\n\n    return '00:00:00:00';\n  }\n  handleMediaDurationChange =(e) => {\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'mediaDuration',\n        name: secondsToTimecode(e.target.duration),\n        value: e.target.duration\n      });\n    }\n  }\n\n  // also now sets default start Time\n  onLoadedDataGetDuration = (e) => {\n    const currentDuration = e.target.duration;\n    const currentDurationWithOffset = currentDuration + this.state.timecodeOffset;\n\n    const durationInSeconds = secondsToTimecode(currentDurationWithOffset);\n\n    this.setState({\n      mediaDuration: durationInSeconds\n    });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'MediaPlayer',\n        action: 'onLoadedDataGetDuration',\n        name: 'durationInSeconds-WithoutOffset',\n        value: secondsToTimecode( currentDuration)\n      });\n    }\n\n    this.setCurrentTime(this.props.defaultStartTime)\n  }\n\n  handlePictureInPicture = () => {\n    if (this.videoRef.current !== null) {\n      if (document.pictureInPictureElement !== undefined) {\n      // from https://developers.google.com/web/updates/2017/09/picture-in-picture\n        if (!document.pictureInPictureElement) {\n\n          this.props.handleAnalyticsEvents({\n            category: 'MediaPlayer',\n            action: 'handlePictureInPicture',\n            name: 'turning-picture-in-picture-on'\n          });\n\n          this.videoRef.current.requestPictureInPicture()\n            .catch(error => {\n              // Video failed to enter Picture-in-Picture mode.\n              console.error('Video failed to enter Picture-in-Picture mode', error);\n\n              this.props.handleAnalyticsEvents({\n                category: 'MediaPlayer',\n                action: 'handlePictureInPicture',\n                name: 'turning-picture-in-picture-on-error'\n              });\n\n            });\n\n        } else {\n          this.props.handleAnalyticsEvents({\n            category: 'MediaPlayer',\n            action: 'handlePictureInPicture',\n            name: 'turning-picture-in-picture-off'\n          });\n          document.exitPictureInPicture()\n            .catch(error => {\n              // Video failed to leave Picture-in-Picture mode.\n              console.error('Video failed to leave Picture-in-Picture mode', error);\n\n              this.props.handleAnalyticsEvents({\n                category: 'MediaPlayer',\n                action: 'handlePictureInPicture',\n                name: 'turning-picture-in-picture-off-error'\n              });\n            });\n        }\n      } else {\n        alert('Picture in Picture not supported in this browser, try chrome.');\n\n        this.props.handleAnalyticsEvents({\n          category: 'MediaPlayer',\n          action: 'handlePictureInPicture',\n          name: 'picture-in-picture-not-supported'\n        });\n\n      }\n    }\n  }\n\n  render() {\n    const player = <VideoPlayer\n      mediaUrl={ this.props.mediaUrl }\n      onTimeUpdate= { this.handleTimeUpdate }\n      onClick= { this.togglePlayMedia.bind(this) }\n      videoRef={ this.videoRef }\n      onLoadedDataGetDuration={ this.onLoadedDataGetDuration }\n    />;\n\n    const playerControlsSection = (\n      <div className={ styles.controlsSection }>\n        <div className={ styles.titleBox }>\n          <h1 className={ styles.title }>{ this.props.fileName? this.props.fileName : this.props.mediaUrl }</h1>\n        </div>\n        <PlayerControls\n          playMedia={ this.togglePlayMedia.bind(this) }\n          isPlaying={ this.state.isPlaying }\n          playbackRate={ this.state.playbackRate }\n          skipBackward={ this.skipBackward.bind(this) }\n          skipForward={ this.skipForward.bind(this) }\n          rollback={ this.rollBack }\n          currentTime={ this.getMediaCurrentTime() }\n          duration={ this.state.mediaDuration }\n          onSetCurrentTime={ '' }\n          onSetTimecodeOffset={ '' }\n          promptSetCurrentTime={ this.promptSetCurrentTime.bind(this) }\n          setTimeCodeOffset={ this.setTimeCodeOffset.bind(this) }\n          timecodeOffset={ secondsToTimecode(this.state.timecodeOffset) }\n          handleMuteVolume={ this.handleMuteVolume.bind(this) }\n          setPlayBackRate={ this.handlePlayBackRateChange.bind(this) }\n          playbackRateOptions={ this.state.playbackRateOptions }\n          pictureInPicture={ this.handlePictureInPicture }\n          handleSaveTranscript={ () => {this.props.handleSaveTranscript();} }\n        />\n      </div>\n    );\n\n    const progressBar = <ProgressBar\n      max={ this.videoRef.current !== null ? parseInt(this.videoRef.current.duration).toString() : '100' }\n      value={ this.videoRef.current !== null ? parseInt(this.videoRef.current.currentTime) : 0 }\n      buttonClick={ this.handleProgressBarClick.bind(this) }\n    />;\n\n    return (\n      <section className={ styles.topSection }>\n        <div className={ styles.playerSection }>\n          { this.props.mediaUrl !== null ? player : null }\n          { this.props.mediaUrl !== null ? playerControlsSection : null }\n        </div>\n        { this.props.mediaUrl !== null ? progressBar : null }\n      </section>\n    );\n  }\n}\n\nMediaPlayer.propTypes = {\n  fileName: PropTypes.string,\n  hookSeek: PropTypes.func,\n  hookPlayMedia: PropTypes.func,\n  hookIsPlaying: PropTypes.func,\n  mediaUrl: PropTypes.string,\n  hookOnTimeUpdate: PropTypes.func,\n  rollBackValueInSeconds: PropTypes.number,\n  timecodeOffset: PropTypes.number\n};\n\nexport default hotkeys(MediaPlayer);\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport style from './index.module.css';\n\nclass Toggle extends React.Component {\n  render() {\n    return (\n      <div className={ style.switchContainer }>\n        <label className={ style.switch }>\n          <input type='checkbox'\n            defaultChecked={ this.props.defaultValue }\n            onChange={ this.props.handleToggle }\n          />\n          <span className={ style.slider }></span>\n        </label>\n      </div>\n    );\n  }\n}\n\nToggle.propTypes = {\n  handleToggle: PropTypes.func,\n  label: PropTypes.string,\n  defaultValue: PropTypes.bool\n};\n\nexport default Toggle;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport style from './index.module.css';\n\nimport { timecodeToSeconds, secondsToTimecode } from '../../../Util/timecode-converter/index';\n\nclass TimecodeOffset extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      timecodeOffset: secondsToTimecode(this.props.timecodeOffset)\n    };\n  }\n\n  handleChange = (e) => {\n    this.setState({\n      timecodeOffset: e.target.value\n    });\n  }\n\n  resetTimecodeOffset = () => {\n    const resetTimecodeOffsetValue = 0;\n\n    this.props.handleAnalyticsEvents({\n      category: 'TimecodeOffset',\n      action: 'resetTimecodeOffset',\n      name: 'resetTimecodeOffset',\n      value: 0\n    });\n\n    this.setState({\n      timecodeOffset: secondsToTimecode(resetTimecodeOffsetValue)\n    }, () => {\n      this.props.handleSetTimecodeOffset(resetTimecodeOffsetValue);\n    });\n  }\n\n  setTimecodeOffset = () => {\n    this.props.handleAnalyticsEvents({\n      category: 'TimecodeOffset',\n      action: 'setTimecodeOffset',\n      name: 'setTimecodeOffset',\n      value: this.state.timecodeOffset\n    });\n\n    let newCurrentTimeInSeconds = this.state.timecodeOffset;\n    if (typeof newCurrentTimeInSeconds ==='string'\n    && newCurrentTimeInSeconds.includes(':')\n    && !newCurrentTimeInSeconds.includes('NaN')) {\n      newCurrentTimeInSeconds = timecodeToSeconds(newCurrentTimeInSeconds );\n    }\n    this.props.handleSetTimecodeOffset(newCurrentTimeInSeconds);\n  }\n\n  render() {\n    return (\n      <div className={ style.offsetContainer }>\n        <input\n          className={ style.inputBox }\n          type=\"text\"\n          value={ this.state.timecodeOffset }\n          onChange={ this.handleChange }\n          name=\"lname\"/>\n        <span className={ style.button } onClick={ this.resetTimecodeOffset }><u>Reset</u></span>\n        <span> | </span>\n        <span className={ style.button } onClick={ this.setTimecodeOffset }><u>Save</u></span>\n      </div>\n    );\n  }\n}\n\nTimecodeOffset.propTypes = {\n  handleSetTimecodeOffset: PropTypes.func,\n  onChange: PropTypes.func,\n  timecodeOffset: PropTypes.number\n};\n\nexport default TimecodeOffset;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faWindowClose } from '@fortawesome/free-solid-svg-icons';\n\nimport Toggle from './Toggle/';\n\nimport style from './index.module.css';\n\nimport TimecodeOffset from './TimecodeOffset';\n\nclass Settings extends React.Component {\n  render() {\n    return (\n      <div className={ style.settings }>\n        <h2 className={ style.header }>Settings Panel</h2>\n        <div className={ style.closeButton } onClick={ this.props.handleSettingsToggle }>\n          <FontAwesomeIcon icon={ faWindowClose } />\n        </div>\n\n        <div className={ style.controlsContainer }>\n          <section className={ style.settingElement }>\n            <div className={ style.label }>Pause While Typing</div>\n            <Toggle\n              defaultValue={ this.props.defaultValuePauseWhileTyping }\n              label={ 'Pause while typing' }\n              handleToggle={ this.props.handlePauseWhileTyping }\n            />\n          </section>\n\n          <section className={ style.settingElement }>\n            <div className={ style.label }>Scroll Sync</div>\n            <Toggle\n              defaultValue={ this.props.defaultValueScrollSync }\n              label={ 'ScrollSync' }\n              handleToggle={ this.props.handleIsScrollIntoViewChange }\n            />\n          </section>\n\n          <section className={ style.settingElement }>\n            <div className={ style.label }>Rollback Interval (sec)</div>\n            <input\n              className={ style.rollbackValue }\n              type=\"text\"\n              value={ this.props.defaultRollBackValueInSeconds }\n              onChange={ this.props.handleRollBackValueInSeconds }\n              name=\"lname\"/>\n          </section>\n\n          <section className={ style.settingElement }>\n            <div className={ style.label }>Show Timecodes</div>\n            <Toggle\n              defaultValue={ this.props.showTimecodes }\n              label={ 'Hide Timecodes' }\n              handleToggle={ this.props.handleShowTimecodes }\n            />\n          </section>\n\n          <section className={ style.settingElement }>\n            <div className={ style.label }>Show Speaker Labels</div>\n            <Toggle\n              defaultValue={ this.props.showSpeakers }\n              label={ 'Hide Speaker Labels' }\n              handleToggle={ this.props.handleShowSpeakers }\n            />\n          </section>\n\n          <section className={ style.settingElement }>\n            <div className={ style.timecodeLabel }>Timecode Offset ℹ</div>\n            <TimecodeOffset\n              timecodeOffset={ this.props.timecodeOffset }\n              handleSetTimecodeOffset={ this.props.handleSetTimecodeOffset }\n              handleAnalyticsEvents={ this.props.handleAnalyticsEvents }\n            />\n          </section>\n        </div>\n      </div>\n    );\n  }\n}\n\nSettings.propTypes = {\n  showTimecodes: PropTypes.bool,\n  showSpeakers: PropTypes.bool,\n  timecodeOffset: PropTypes.number,\n  handleShowTimecodes: PropTypes.func,\n  handleShowSpeakers: PropTypes.func,\n  handleSetTimecodeOffset: PropTypes.func,\n  handleSettingsToggle: PropTypes.func,\n  handlePauseWhileTyping: PropTypes.func,\n  handleIsScrollIntoViewChange: PropTypes.func,\n  handleRollBackValueInSeconds: PropTypes.func,\n  defaultValueScrollSync: PropTypes.bool,\n  defaultValuePauseWhileTyping: PropTypes.bool,\n  defaultRollBackValueInSeconds: PropTypes.number\n};\n\nexport default Settings;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faWindowClose } from '@fortawesome/free-solid-svg-icons';\n\nimport returnHotKeys from '../MediaPlayer/defaultHotKeys';\n\nimport style from './Shortcuts.module.css';\n\nclass Shortcuts extends React.Component {\n  render() {\n    const hotKeys = returnHotKeys(this);\n    const hotKeysCheatsheet = Object.keys(hotKeys).map((key, i) => {\n    \tconst shortcut = hotKeys[key];\n\n      return <li key={ i } className={ style.listItem }>\n        <div className={ style.shortcut }>{shortcut.displayKeyCombination}</div>\n        <div className={ style.shortcutLabel }>{shortcut.label}</div>\n      </li>;\n    });\n\n    return (\n      <div className={ style.shortcuts }>\n        <h2 className={ style.header }>Shortcuts</h2>\n        <div className={ style.closeButton } onClick={ this.props.handleShortcutsToggle }>\n          <FontAwesomeIcon icon={ faWindowClose } />\n        </div>\n        <ul className={ style.list }>{ hotKeysCheatsheet }</ul>\n      </div>\n    );\n  }\n}\n\nShortcuts.propTypes = {\n  handleShortcutsToggle: PropTypes.func\n};\n\nexport default Shortcuts;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCog, faKeyboard } from '@fortawesome/free-solid-svg-icons';\n\nimport TimedTextEditor from './TimedTextEditor';\nimport MediaPlayer from './MediaPlayer';\nimport Settings from './Settings';\nimport Shortcuts from './Settings/Shortcuts';\nimport { secondsToTimecode } from '../Util/timecode-converter/index';\n\nimport style from './index.module.css';\n\nconst urlParams = new URLSearchParams(window.location.search);\n\nclass TranscriptEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    let startTime = urlParams.has('startTime') ? parseFloat(urlParams.get('startTime')) : 0;\n    if (isNaN(startTime)) {\n      startTime = 0\n    }\n\n    this.state = {\n      defaultStartTime: startTime,\n      currentTime: startTime,\n      lastLocalSavedTime: '',\n      transcriptData: null,\n      isScrollIntoViewOn: true,\n      showSettings: false,\n      showShortcuts: false,\n      isPauseWhileTypingOn: true,\n      rollBackValueInSeconds: 5,\n      timecodeOffset: 0,\n      showTimecodes: true,\n      showSpeakers: true\n    };\n    this.timedTextEditorRef = React.createRef();\n  }\n\n  static getDerivedStateFromProps(nextProps) {\n    if (nextProps.transcriptData !== null) {\n      return {\n        transcriptData: nextProps.transcriptData\n      };\n    }\n\n    return null;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // Transcript and media passed to component at same time\n    if (\n      (prevState.transcriptData !== this.state.transcriptData)\n        && (prevProps.mediaUrl !== this.props.mediaUrl )\n    ) {\n      console.info('Transcript and media');\n      this.ifPresentRetrieveTranscriptFromLocalStorage();\n    }\n    // Transcript first and then media passed to component\n    else if (\n      (prevState.transcriptData === this.state.transcriptData)\n      && (prevProps.mediaUrl !== this.props.mediaUrl)\n    ) {\n      console.info('Transcript first and then media');\n      this.ifPresentRetrieveTranscriptFromLocalStorage();\n    }\n    // Media first and then transcript passed to component\n    else if (\n      (prevState.transcriptData !== this.state.transcriptData)\n      && (prevProps.mediaUrl === this.props.mediaUrl)\n    ) {\n      console.info('Media first and then transcript');\n      this.ifPresentRetrieveTranscriptFromLocalStorage();\n    }\n  }\n\n  ifPresentRetrieveTranscriptFromLocalStorage = () => {\n    // if (this.timedTextEditorRef.current!== undefined) {\n    if (this.timedTextEditorRef.current) {\n      if (this.timedTextEditorRef.current.isPresentInLocalStorage(this.props.mediaUrl)) {\n        console.info('was already present in local storage');\n        this.timedTextEditorRef.current.loadLocalSavedData(this.props.mediaUrl);\n      } else {\n        console.info('not present in local storage');\n      }\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  // when double click a single word\n  handleWordClick = (startTime) => {\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'doubleClickOnWord',\n        name: 'startTime',\n        value: secondsToTimecode(startTime)\n      });\n    }\n\n    this.jumpToHere(startTime)\n  }\n\n  handleJumpToHereClick = (startTime) => {\n    this.jumpToHere(startTime)\n  }\n\n  jumpToHere = (startTime) => {\n    // TODO add analytics stuff...except I don't care right now haha\n\n    // happens if the data gets messed up and they click on a paragraph that has that faulty data\n    // TODO allow editing timing so this can get fixed\n    if ([ NaN, undefined ].includes(startTime)) {\n      console.error(\"startTime cannot be set to be NaN or undefined\");\n\n      return\n    }\n    this.setCurrentTime(startTime);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  handleTimeUpdate = (currentTime) => {\n    this.setState({\n      currentTime,\n    });\n  }\n\n  handlePlayMedia = (bool) => {\n    this.playMedia(null, bool);\n  }\n\n  handleIsPlaying = () => {\n    return this.isPlaying();\n  }\n\n  handleIsScrollIntoViewChange = (e) => {\n    const isChecked = e.target.checked;\n    this.setState({ isScrollIntoViewOn: isChecked });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleIsScrollIntoViewChange',\n        name: 'isScrollIntoViewOn',\n        value: isChecked\n      });\n    }\n\n  }\n  handlePauseWhileTyping = (e) => {\n    const isChecked = e.target.checked;\n    this.setState({ isPauseWhileTypingOn: isChecked });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handlePauseWhileTyping',\n        name: 'isPauseWhileTypingOn',\n        value: isChecked\n      });\n    }\n  }\n\n  handleRollBackValueInSeconds = (e) => {\n    const rollBackValue = e.target.value;\n    this.setState({ rollBackValueInSeconds: rollBackValue });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleRollBackValueInSeconds',\n        name: 'rollBackValueInSeconds',\n        value: rollBackValue\n      });\n    }\n  }\n\n  handleSetTimecodeOffset = (timecodeOffset) => {\n\n    this.setState({ timecodeOffset: timecodeOffset },\n      () => {\n        // eslint-disable-next-line react/no-string-refs\n        this.timedTextEditorRef.current.forceUpdate();\n      });\n  }\n\n  handleShowTimecodes = (e) => {\n    const isChecked = e.target.checked;\n    this.setState({ showTimecodes: isChecked });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleShowTimecodes',\n        name: 'showTimecodes',\n        value: isChecked\n      });\n    }\n  }\n\n  handleShowSpeakers = (e) => {\n    const isChecked = e.target.checked;\n    this.setState({ showSpeakers: isChecked });\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleShowSpeakers',\n        name: 'showSpeakers',\n        value:  isChecked\n      });\n    }\n  }\n\n  handleSettingsToggle = () => {\n    this.setState(prevState => ({\n      showSettings: !prevState.showSettings\n    }));\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleSettingsToggle',\n        name: 'showSettings',\n        value:  !this.state.showSettings\n      });\n    }\n  }\n\n  handleShortcutsToggle = () => {\n    this.setState(prevState => ({\n      showShortcuts: !prevState.showShortcuts\n    }));\n\n    if (this.props.handleAnalyticsEvents !== undefined) {\n      this.props.handleAnalyticsEvents({\n        category: 'TranscriptEditor',\n        action: 'handleShortcutsToggle',\n        name: 'showShortcuts',\n        value:  !this.state.showShortcuts\n      });\n    }\n  }\n\n  getEditorContent = (exportFormat) => {\n    return this.timedTextEditorRef.current.getEditorContent(exportFormat);\n  }\n\n  handleSaveTranscript = () => {\n    return this.timedTextEditorRef.current.localSave(this.props.mediaUrl);\n  }\n\n  render() {\n    const mediaPlayer = <MediaPlayer\n      fileName={ this.props.fileName }\n      hookSeek={ foo => this.setCurrentTime = foo }\n      hookPlayMedia={ foo => this.playMedia = foo }\n      hookIsPlaying={ foo => this.isPlaying = foo }\n      rollBackValueInSeconds={ this.state.rollBackValueInSeconds }\n      timecodeOffset={ this.state.timecodeOffset }\n      hookOnTimeUpdate={ this.handleTimeUpdate }\n      mediaUrl={ this.props.mediaUrl }\n      // ref={ 'MediaPlayer' }\n      handleAnalyticsEvents={ this.props.handleAnalyticsEvents }\n      handleSaveTranscript={ this.handleSaveTranscript }\n      playingWhileListening = { this.props.playingWhileListening }\n      timedTextEditorRef = { this.timedTextEditorRef.current }\n      defaultStartTime = { this.state.defaultStartTime } \n    />;\n\n    const settings = <Settings\n      handleSettingsToggle={ this.handleSettingsToggle }\n      defaultValuePauseWhileTyping={ this.state.isPauseWhileTypingOn }\n      defaultValueScrollSync={ this.state.isScrollIntoViewOn }\n      defaultRollBackValueInSeconds={ this.state.rollBackValueInSeconds }\n      timecodeOffset={ this.state.timecodeOffset }\n      showTimecodes={ this.state.showTimecodes }\n      showSpeakers={ this.state.showSpeakers }\n      handlePauseWhileTyping={ this.handlePauseWhileTyping }\n      handleIsScrollIntoViewChange={ this.handleIsScrollIntoViewChange }\n      handleRollBackValueInSeconds={ this.handleRollBackValueInSeconds }\n      handleSetTimecodeOffset={ this.handleSetTimecodeOffset }\n      handleShowTimecodes={ this.handleShowTimecodes }\n      handleShowSpeakers={ this.handleShowSpeakers }\n      handleAnalyticsEvents={ this.props.handleAnalyticsEvents }\n    />;\n\n    const shortcuts = <Shortcuts\n      handleShortcutsToggle={ this.handleShortcutsToggle }\n    />;\n\n    const timedTextEditor = <TimedTextEditor\n      fileName={ this.props.fileName }\n      transcriptData={ this.state.transcriptData }\n      timecodeOffset={ this.state.timecodeOffset }\n      onWordClick={ this.handleWordClick }\n      onJumpToHereClick={ this.handleJumpToHereClick }\n      playMedia={ this.handlePlayMedia }\n      isPlaying={ this.handleIsPlaying }\n      currentTime={ this.state.currentTime }\n      isEditable={ this.props.isEditable }\n      sttJsonType={ this.props.sttJsonType }\n      mediaUrl={ this.props.mediaUrl }\n      isScrollIntoViewOn={ this.state.isScrollIntoViewOn }\n      isPauseWhileTypingOn={ this.state.isPauseWhileTypingOn }\n      showTimecodes={ this.state.showTimecodes }\n      showSpeakers={ this.state.showSpeakers }\n      ref={ this.timedTextEditorRef }\n      handleAnalyticsEvents={ this.props.handleAnalyticsEvents }\n    />;\n\n    return (\n      <div className={ style.container }>\n        <header className={ style.header }>\n          { this.state.showSettings ? settings : null }\n          { this.state.showShortcuts ? shortcuts : null }\n        </header>\n\n        <aside className={ style.aside }>{ this.props.mediaUrl ? mediaPlayer : null }</aside>\n\n        <div className={ style.settingsContainer }>\n          <button className={ style.settingsButton } onClick={ this.handleSettingsToggle }>\n            <FontAwesomeIcon icon={ faCog } />\n          </button>\n          <button className={ style.settingsButton } onClick={ this.handleShortcutsToggle }>\n            <FontAwesomeIcon icon={ faKeyboard } />\n          </button>\n        </div>\n\n        <main className={ style.main }>\n          {this.props.mediaUrl === null? null : timedTextEditor}\n        </main>\n      </div>\n    );\n  }\n}\n\nTranscriptEditor.propTypes = {\n  mediaUrl: PropTypes.string,\n  isEditable: PropTypes.bool,\n  sttJsonType: PropTypes.string,\n  handleAnalyticsEvents: PropTypes.func,\n  fileName: PropTypes.string\n};\n\nexport default TranscriptEditor;\n","import SpeechRecognition from './SpeechRecognition'\n\nexport default SpeechRecognition\n","import React, { Component } from 'react'\n\nexport default function SpeechRecognition(options) {\n  const SpeechRecognitionInner = function (WrappedComponent) {\n    const BrowserSpeechRecognition =\n      typeof window !== 'undefined' &&\n      (window.SpeechRecognition ||\n        window.webkitSpeechRecognition ||\n        window.mozSpeechRecognition ||\n        window.msSpeechRecognition ||\n        window.oSpeechRecognition)\n    const recognition = BrowserSpeechRecognition\n      ? new BrowserSpeechRecognition()\n      : null\n    const browserSupportsSpeechRecognition = recognition !== null\n    let listening\n    if (\n      !browserSupportsSpeechRecognition ||\n      (options && options.autoStart === false)\n    ) {\n      listening = false\n    } else {\n      recognition.start()\n      listening = true\n    }\n    let pauseAfterDisconnect = false\n    let interimTranscript = ''\n    let finalTranscript = ''\n\n    // TODO put this as the retval key using template found in src/sample-data/KateDarling_2018S-bbc-kaldi.json\n    const newTranscriptData = () => ({\n      status: true,\n      wonid: \"octo:2692ea33-d595-41d8-bfd5-aa7f2d2f89ee\", // don't know this one, probably will generate something\n      punct: \"\", // total transcript of all the words TODO currently not setting\n      words: [], // array of newWordData objects\n    })\n    \n\n    return class SpeechRecognitionContainer extends Component {\n      constructor(props) {\n        super(props)\n\n        this.state = {\n          interimTranscript,\n          finalTranscript,\n          transcriptData: {},\n          listening: false,\n          allResults: [],\n          speechTimerStartedAt: false, // ms since Jan 1 1970\n        }\n\n        // TODO do the binding thing so don't have to do the crazy arrow funcs here\n      }\n\n      componentWillMount() {\n        if (recognition) {\n          recognition.continuous = false // originally set to true, but this breaks up the words into smaller fragments much better\n          recognition.interimResults = true\n          recognition.onresult = this.updateTranscript.bind(this)\n          recognition.onend = this.onRecognitionDisconnect.bind(this)\n          // onspeechstart/end or onsoundstart/end might be useful\n          /*\n    recognition.onspeechend = () => {console.log(\"speech is now ending\")}\n    recognition.onspeechstart = () => {console.log(\"speech is now starting\")}\n    recognition.onsoundstart = () => {console.log(\"sound is now starting\")}\n    recognition.onsoundend = () => {console.log(\"sound is now ending\")}\n    recognition.nomatch = () => {console.log(\"no match!!!11\")}\n    recognition.onboundary = () => {console.log(\"boundary found!\")}\n    recognition.onresume = () => {console.log(\"resume found!\")}\n    recognition.onmark = () => {console.log(\"mark found!\")}\n    recognition.onpause = () => {console.log(\"pause found!\")}\n    */\n          this.setState({\n            listening,\n            transcriptData: newTranscriptData()\n          })\n        }\n      }\n\n      disconnect (disconnectType) {\n        if (recognition) {\n          switch (disconnectType) {\n            case 'ABORT':\n              pauseAfterDisconnect = true\n              recognition.abort()\n              break\n            case 'RESET':\n              pauseAfterDisconnect = false\n              recognition.abort()\n              break\n            case 'STOP':\n            default:\n              pauseAfterDisconnect = true\n              recognition.stop()\n          }\n        }\n      }\n\n      // minutes elapsed since started.\n      minElapsed = () => {\n        return (Date.now() - this.state.speechTimerStartedAt)/1000;\n      }\n\n      newWordData = (wordResults) => {\n        const words = wordResults.transcript;\n        // remove all punctuation and lowercase it\n        const allWordData = this.state.transcriptData.words;\n        const start = allWordData.length > 0 ? allWordData[allWordData.length - 1].end : 0;\n        const end = this.minElapsed();\n        const punct = words.toLowerCase().replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, '');\n\n        // format required for the bbc lib\n        return {\n          start, // time in minutes, using decimals not seconds, eg 13.02 (float)\n          confidence: wordResults.confidence, // %, out of 1, eg 0.68 (float)\n          end, // end time in min\n          word: words, // all words, not formatted (and lowercase), eg \"there\" (string)\n          punct, // word, as displayed, eg \"There\" (string)\n          index: allWordData.length,\n        }\n      }\n\n      onRecognitionDisconnect = () => {\n        listening = false\n        if (pauseAfterDisconnect) {\n          this.setState({ listening })\n        } else {\n          this.startListening()\n        }\n        pauseAfterDisconnect = false\n      }\n\n      // TODO might stop getting interim results and handling them if it hurts performance\n      updateTranscript = (event) => {\n        interimTranscript = ''\n        // looks like they iterate over same results every time, rather than gradually compiling as it goes. Could slow things down if transcript gets long TODO\n        let newState = {\n          // might not need\n          allResults: event.results\n        }\n\n        for (let i = event.resultIndex; i < event.results.length; ++i) {\n          if (event.results[i].isFinal) {\n            let wordResults = event.results[i][0]\n            finalTranscript = this.concatTranscripts(\n              finalTranscript,\n              wordResults.transcript\n            )\n\n            let newWordData = this.newWordData(wordResults)\n            //TODO bad practice modifying original object like this!\n            let transcriptData = this.state.transcriptData\n            transcriptData.words.push(newWordData)\n            \n            newState.finalTranscript = finalTranscript\n            newState.transcriptData = transcriptData\n\n          } else {\n            interimTranscript = this.concatTranscripts(\n              interimTranscript,\n              event.results[i][0].transcript\n            )\n            newState.finalTranscript = interimTranscript\n          }\n        }\n\n        this.setState(newState)\n      }\n\n      // returns string with all transcript together\n      concatTranscripts(...transcriptParts) {\n        return transcriptParts.map(t => t.trim()).join(' ').trim()\n      }\n\n      resetTranscript = () => {\n        interimTranscript = ''\n        finalTranscript = ''\n        this.disconnect('RESET')\n        this.setState({ \n          interimTranscript, \n          finalTranscript,\n          transcriptData: newTranscriptData(),\n          speechTimerStartedAt: false,\n        })\n      }\n\n      startListening = () => {\n        if (recognition && !listening) {\n          try {\n            recognition.start()\n          } catch (DOMException) {\n            // Tried to start recognition after it has already started - safe to swallow this error\n          }\n          listening = true\n          let newState = {listening}\n          if (!this.state.speechTimerStartedAt) {\n            newState.speechTimerStartedAt = Date.now()\n          }\n\n          this.setState(newState)\n        }\n      }\n\n      abortListening = () => {\n        listening = false\n        this.setState({ listening })\n        this.disconnect('ABORT')\n      }\n\n      stopListening = () => {\n        listening = false\n        this.setState({ listening })\n        this.disconnect('STOP')\n      }\n\n      render() {\n        // includes both\n        const transcript = this.concatTranscripts(\n          finalTranscript,\n          interimTranscript\n        )\n\n        const totalTimeElapsed = this.minElapsed()\n\n        return (\n          <WrappedComponent\n            resetTranscript={this.resetTranscript}\n            startListening={this.startListening}\n            abortListening={this.abortListening}\n            stopListening={this.stopListening}\n            transcript={transcript}\n            recognition={recognition}\n            allResults={this.state.allResults}\n            listening={this.state.listening}\n            transcriptData={this.state.transcriptData}\n            interimTranscript={this.state.interimTranscript}\n            finalTranscript={this.state.finalTranscript}\n            browserSupportsSpeechRecognition={browserSupportsSpeechRecognition}\n            totalTimeElapsed={totalTimeElapsed}\n            {...this.props} />\n        )\n      }\n    }\n  }\n\n  if (typeof options === 'function') {\n    return SpeechRecognitionInner(options)\n  } else {\n    return SpeechRecognitionInner\n  }\n}\n","import React, { Component } from 'react'\n// import getAudio from './getAudio'\nimport SpeechRecognition from '../updated-react-speech-recognition/src/'\nimport { secondsToTimecode, timecodeToSeconds } from '../Util/timecode-converter/index';\n\n/*\nconst propTypes = {\n  // Props injected by SpeechRecognition\n  transcript: PropTypes.string,\n  resetTranscript: PropTypes.func,\n  browserSupportsSpeechRecognition: PropTypes.bool\n}\n*/\n\nclass GenerateTranscript extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n    };\n\n    this.stop = this.stop.bind(this)\n    this.start = this.start.bind(this)\n    this.reset = this.reset.bind(this)\n    this.generateJSON = this.generateJSON.bind(this)\n\n    // props.recognition.onresult\n    // set default language to Khmer TODO add options?\n    // https://www.science.co.il/language/Locale-codes.php for codes\n    props.recognition.lang = \"km\"\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.playingWhileListening && !prevProps.playingWhileListening && !this.props.listening) {\n      this.props.startListening()\n    }\n  }\n\n  stop(e) {\n    this.props.stopListening()\n  }\n  start(e) {\n    // console.log(\"starting\")\n    this.props.startListening()\n  }\n  generateJSON(e) {\n    let transcriptJSON = {\n      action: \"audio-transcribe\",\n      retval: this.props.transcriptData\n    }\n    // if use finalTranscript, anything that hasn't been finalized isn't counted, which would be confusing, since even if you wait sometimes it isn't yet made final\n    transcriptJSON.retval.punct = this.props.transcript\n\n    this.setState({\n      transcriptJSON\n    })\n\n    // console.log(transcriptJSON)\n    // content, filename, format\n    let filename = this.props.fileName.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, \"\").replace(/\\s/g, \"-\")\n    let prettyData = JSON.stringify(transcriptJSON, null, 4)\n\n    this.props.download(prettyData, `${ filename }.json`)\n\n    return transcriptJSON\n  }\n  reset(e) {\n    this.props.resetTranscript()\n  }\n  render() {\n    const {\n      transcript,\n      browserSupportsSpeechRecognition,\n      // interimTranscript,\n      listening,\n      // allResults\n    } = this.props\n\n    if (!browserSupportsSpeechRecognition) {\n      // NOTE happens several times, as this gets rerendered for some reason. Returns false even when browser can support sometimes for some reason too, but eventually returns true\n      return null\n    }\n    //TODO add back in once we switch over to using my fork  which passes down all results as an array rather than compiling all into a string\n\n    return (\n      <div>\n        <h1>Speech Recognition</h1>\n        <button onClick = { this.reset } >Reset</button>\n        <button onClick = { this.start } >Start</button>\n        <button onClick = { this.stop } >Stop</button>\n        <button onClick = { this.generateJSON } >Generate Transcript JSON</button>\n        <div className=\"transcript-container\" style={ { height: '240px', overflowY: 'auto' } }>\n          {\n            <div>{transcript}</div>\n          }\n        </div>\n        { listening ? (\n          <span>\n            *Listening* Total Time Elapsed: {secondsToTimecode(this.props.totalTimeElapsed)}\n          </span>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n        {false && <div>\n          <p>Volume</p>\n          <input id=\"volume\" type=\"range\" min=\"0\" max=\"1\" step=\"0.1\" value=\"0.5\"/>\n        </div>}\n\n      </div>\n    )\n  }\n}\n\n// GenerateTranscript.propTypes = propTypes\n\nconst options = {\n  autoStart: false\n}\nexport default SpeechRecognition(options)(GenerateTranscript)\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst SttTypeSelect = props => (<select name={ props.name } value={ props.value } onChange={ props.handleChange }>\n  <option value=\"bbckaldi\">BBC Kaldi</option>\n  <option value=\"draftjs\">Draft Js</option>\n  <option value=\"gentle-transcript\" disabled>Gentle Transcript</option>\n  <option value=\"gentle-alignement\" disabled>Gentle Alignement</option>\n  <option value=\"iiif\" disabled>IIIF</option>\n  <option value=\"autoedit2\">autoEdit 2</option>\n  <option value=\"ibm\" disabled>IBM Watson STT</option>\n  <option value=\"speechmatics\">Speechmatics</option>\n  <option value=\"assemblyai\" disabled>AssemblyAI</option>\n  <option value=\"rev\" disabled>Rev</option>\n  <option value=\"srt\" disabled>Srt</option>\n  <option value=\"vtt\" disabled>VTT</option>\n  <option value=\"vtt-youtube\" disabled>Youtube VTT</option>\n</select>);\n\nSttTypeSelect.propTypes = {\n  name: PropTypes.string,\n  value: PropTypes.string,\n  handleChange: PropTypes.func\n};\n\nexport default SttTypeSelect;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst ExportFormatSelect = props => (<select name={ props.name } value={ props.value } onChange={ props.handleChange }>\n  <option value=\"draftjs\">Draft Js</option>\n  <option value=\"txt\">Text file</option>\n  <option value=\"html\" disabled>HTML</option>\n  <option value=\"word\" disabled>MS Word</option>\n</select>);\n\nExportFormatSelect.propTypes = {\n  name: PropTypes.string,\n  value: PropTypes.string,\n  handleChange: PropTypes.func\n};\n\nexport default ExportFormatSelect;\n","import React from 'react';\nimport { render } from 'react-dom';\n\nimport { TranscriptEditor, GenerateTranscript } from './lib';\n\nimport kaldiTedTalkTranscript from './sample-data/KateDarling_2018S-bbc-kaldi.json';\nimport style from './index.module.css';\nimport SttTypeSelect from './select-stt-json-type';\nimport ExportFormatSelect from './select-export-format';\n\nimport hunSenInterviewPart1Transcript from './sample-data/Hun-Sen-interview-part1-transcript-data.json';\n\nconst tedTalkVideoUrl = 'https://download.ted.com/talks/KateDarling_2018S-950k.mp4';\nconst hunSenInterview1Url360px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/4/43/43e10b36-b843-4fea-9a66-1160373adede.mp4?download=1';\nconst hunSenInterview1Url270px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/4/43/43e10b36-b843-4fea-9a66-1160373adede_mobile.mp4?download=1';\nconst hunSenInterview2Url360px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/8/85/85b38eb5-a8cc-4ef9-827c-eab331e7f5a2.mp4?download=1';\nconst hunSenInterview2Url270px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/8/85/85b38eb5-a8cc-4ef9-827c-eab331e7f5a2_mobile.mp4?download=1';\nconst hunSenInterview3Url360px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/a/af/af67500f-9491-47f6-8e26-1c6f7a3827d6.mp4?download=1';\nconst hunSenInterview3Url270px = 'https://av.voanews.com/Videoroot/Pangeavideo/2018/09/a/af/af67500f-9491-47f6-8e26-1c6f7a3827d6_mobile.mp4?download=1';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      transcriptData: null,\n      mediaUrl: null,\n      isTextEditable: true,\n      sttType: 'bbckaldi',\n      analyticsEvents: [],\n      fileName: 'Khmer Transcript Data',\n      playingWhileListening: false,\n    };\n\n    this.transcriptEditorRef = React.createRef();\n    this.startListeningAndPlayingMedia = this.startListeningAndPlayingMedia.bind(this)\n  }\n\n  loadDemo() {\n    this.setState({\n      transcriptData: hunSenInterviewPart1Transcript,\n      mediaUrl: hunSenInterview1Url360px,\n      sttType: 'bbckaldi',\n      fileName: 'Hun Sen interview part1 transcript data',\n    });\n  }\n\n  startListeningAndPlayingMedia(e) {\n    this.setState({playingWhileListening: true})\n  }\n\n  // https://stackoverflow.com/questions/8885701/play-local-hard-drive-video-file-with-html5-video-tag\n  handleChangeLoadMedia(files) {\n    console.log(files);\n    const file = files[0];\n    const type = file.type;\n    // check if is playable\n    const videoNode = document.createElement('video');\n    const canPlay = videoNode.canPlayType(type);\n    if (canPlay) {\n      const fileURL = URL.createObjectURL(file);\n      // videoNode.src = fileURL\n      this.setState({\n        // transcriptData: kaldiTedTalkTranscript,\n        mediaUrl: fileURL,\n        fileName: file.name\n      });\n    }\n    else {\n      alert('select a valid audio or video file');\n    }\n  }\n\n  handleChangeLoadMediaUrl() {\n    const fileURL = prompt(\"Paste the URL you'd like to use here\");\n\n    this.setState({\n      // transcriptData: kaldiTedTalkTranscript,\n      mediaUrl: fileURL,\n    });\n  }\n\n  handleChangeLoadTranscriptJson(files) {\n    const file = files[0];\n\n    if (file.type ==='application/json') {\n      const fr = new FileReader();\n\n      fr.onload = (evt) => {\n        this.setState({\n          transcriptData: JSON.parse(evt.target.result)\n        });\n      };\n\n      fr.readAsText(file);\n\n    }\n    else {\n      alert('select a valid json file');\n    }\n  }\n\n  handleIsTextEditable = () => {\n    this.setState((prevState) => ({ isTextEditable: (prevState.isTextEditable) !== true }));\n  }\n\n  // https://stackoverflow.com/questions/21733847/react-jsx-selecting-selected-on-selected-select-option\n  handleSttTypeChange = (event) => {\n    console.log(event.target.name, event.target.value);\n    this.setState({ [event.target.name]: event.target.value });\n  }\n\n  handleExportFormatChange = (event) => {\n    console.log(event.target.name, event.target.value);\n    this.setState({ [event.target.name]: event.target.value });\n  }\n\n  exportTranscript = () => {\n    // eslint-disable-next-line react/no-string-refs\n    const { data, ext } = this.transcriptEditorRef.current.getEditorContent(this.state.exportFormat);\n    this.download(data, `${ this.state.mediaUrl }.${ ext }`);\n  }\n\n  // https://stackoverflow.com/questions/2897619/using-html5-javascript-to-generate-and-save-a-file\n  download = (content, filename, contentType) => {\n    const type = contentType || 'application/octet-stream';\n    const a = document.createElement('a');\n    const blob = new Blob([ content ], { type: type });\n\n    a.href = window.URL.createObjectURL(blob);\n    a.download = filename;\n    a.click();\n  }\n\n   clearLocalStorage = () => {\n     localStorage.clear();\n     console.info('cleared local storage');\n   }\n\n   handleAnalyticsEvents = (event) => {\n     this.setState({ analyticsEvents: [ ...this.state.analyticsEvents, event ] });\n   }\n\n   handleChangeTranscriptName = (value) => {\n     this.setState({ fileName: value });\n   }\n\n   playMedia\n   render() {\n     return (\n       <div className={ style.container }>\n         <span className={ style.title }>\n            Demo page for <mark>Khmer Transcript Creator</mark> - Component |&nbsp;\n           <a\n             href=\"https://github.com/RyanQuey/react-transcript-editor\"\n             rel=\"noopener noreferrer\"\n             target=\"_blank\"\n           >\n            Github Repo\n           </a>\n         </span>\n         <GenerateTranscript\n           download = { this.download }\n           fileName = {this.state.fileName}\n           playingWhileListening = { this.state.playingWhileListening }\n         />\n         <br />\n         <button onClick={ () => this.loadDemo() }>load demo</button>\n         <hr />\n         <label>Load Local Audio or Video Media:&nbsp;</label>\n         <input\n           type=\"file\"\n           onChange={ e => this.handleChangeLoadMedia(e.target.files) }\n         />\n         or&nbsp;\n         <button onClick={ () => this.handleChangeLoadMediaUrl() }>\n          Load Media From Url\n         </button>\n         <br/>\n         <label>Transcript Json Format:&nbsp;</label>\n         <SttTypeSelect\n           name={ 'sttType' }\n           value={ this.state.sttType }\n           handleChange={ this.handleSttTypeChange }\n         />\n         &nbsp;&nbsp;\n         <label>Transcript Json:&nbsp;</label>\n         <input\n           type=\"file\"\n           onChange={ e => this.handleChangeLoadTranscriptJson(e.target.files) }\n         />\n         <br />\n\n         <label>Text Is Editable</label>\n         <label className={ style.switch }>\n           <input type=\"checkbox\"\n             defaultChecked=\"true\"\n             onChange={ this.handleIsTextEditable }\n           />\n           <span className={ style.slider }></span>\n         </label>\n         <br />\n\n         <label>Transcript Name</label>\n         <input\n           type=\"text\"\n           onChange={ e => this.handleChangeTranscriptName(e.target.value) }\n           value={ this.state.fileName }\n         />\n         <br />\n\n         <label>Export Edited Transcript:&nbsp;</label>\n         <button onClick={ () => this.exportTranscript() }>Export</button>\n\n         <ExportFormatSelect\n           name={ 'exportFormat' }\n           value={ this.state.exportFormat }\n           handleChange={ this.handleExportFormatChange }\n         />\n         <br />\n\n         <button onClick={ () => this.clearLocalStorage() }>Clear Local Storage</button>\n         {this.state.mediaUrl &&\n           <button onClick={ () => this.startListeningAndPlayingMedia() }>Generate Transcript from Media</button>\n         }\n         <hr/>\n\n         <TranscriptEditor\n           transcriptData = { this.state.transcriptData }\n           fileName = { this.state.fileName }\n           mediaUrl = { this.state.mediaUrl }\n           isEditable = { this.state.isTextEditable }\n           sttJsonType = { this.state.sttType }\n           handleAnalyticsEvents = { this.handleAnalyticsEvents }\n           ref = { this.transcriptEditorRef }\n           playingWhileListening = { this.state.playingWhileListening }\n         />\n         <hr/>\n\n         { false && \"TODO not worrying about right now\" && <div>\n           <label>Components Analytics</label>\n           <textarea\n             style={ { height: '200px', width: '100%' } }\n             value={ JSON.stringify(this.state.analyticsEvents, null, 2) }\n             disabled>\n           </textarea>\n         </div> }\n       </div>\n     );\n   }\n}\n\nrender(<App />, document.getElementById('root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-lightest-grey\":\"#f2f2f2\",\"color-labs-red\":\"#a0372d\",\"color-dark-grey\":\"#4a4a4a\",\"shortcuts\":\"Shortcuts_shortcuts__E-szq\",\"header\":\"Shortcuts_header__ujg-G\",\"closeButton\":\"Shortcuts_closeButton__1uaCk\",\"list\":\"Shortcuts_list__1wVGG\",\"listItem\":\"Shortcuts_listItem__Jnjzl\",\"shortcut\":\"Shortcuts_shortcut__GWLsC\",\"shortcutLabel\":\"Shortcuts_shortcutLabel__1cOKX\",\"settingElement\":\"Shortcuts_settingElement__38_ln\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-subt-green\":\"#69e3c2\",\"color-darkest-grey\":\"#282828\",\"color-labs-red\":\"#a0372d\",\"container\":\"TranscriptEditor_container__2Ykm6\",\"header\":\"TranscriptEditor_header__3PNk9\",\"main\":\"TranscriptEditor_main__VyUon\",\"aside\":\"TranscriptEditor_aside__fkJSE\",\"settingsContainer\":\"TranscriptEditor_settingsContainer__LUrRi\",\"settingsButton\":\"TranscriptEditor_settingsButton__1jEwK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-light-grey\":\"#767676\",\"topSection\":\"MediaPlayer_topSection__2Wqp0\",\"playerSection\":\"MediaPlayer_playerSection__1WRFX\",\"controlsSection\":\"MediaPlayer_controlsSection__2JdaW\",\"titleBox\":\"MediaPlayer_titleBox__2Alx5\",\"title\":\"MediaPlayer_title__1Tw_5\",\"helpText\":\"MediaPlayer_helpText__3vCf-\",\"hideInMobile\":\"MediaPlayer_hideInMobile__1PWAN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-labs-red\":\"#a0372d\",\"switchContainer\":\"VolumeControl_switchContainer__3Rvar\",\"label\":\"VolumeControl_label__3BTVJ\",\"switch\":\"VolumeControl_switch__39OLJ\",\"slider\":\"VolumeControl_slider__nvKJY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"offsetContainer\":\"TimecodeOffset_offsetContainer__3IRin\",\"inputBox\":\"TimecodeOffset_inputBox__1lmnx\",\"button\":\"TimecodeOffset_button__5qwpw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"src_container__3zVEP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-labs-red\":\"#a0372d\",\"switchContainer\":\"Toggle_switchContainer__3i-of\",\"label\":\"Toggle_label__1xsUr\",\"switch\":\"Toggle_switch__v31XM\",\"slider\":\"Toggle_slider__3r6Az\"};"],"sourceRoot":""}